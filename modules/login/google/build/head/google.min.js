function isLoginSuccesful(b){if(!/logout/i.test(b)){var a=getParam(b,null,null,/<span[^>]+id="errormsg[^>]*>([\s\S]*?)<\/span>/i,replaceTagsAndSpaces,html_entity_decode);if(a)throw new AnyBalance.Error(a);if(a=getParam(b,null,null,/<form[^>]+id="challenge"/i,replaceTagsAndSpaces,html_entity_decode))throw new AnyBalance.Error("This account requires 2-step authorization. Turn off 2-step authorization to use this provider.");AnyBalance.trace(b);throw new AnyBalance.Error("Can`t log in, is the site changed?");
}return!0}
function googleLogin(b){try{AnyBalance.restoreCookies()}catch(e){}var a=AnyBalance.requestGet("https://accounts.google.com/ServiceLoginAuth",g_headers),a=getParam(a,null,null,/GALX[^>]*value=['"]([^"']+)/i);if(!a)throw new AnyBalance.Error("Can`t find find login form, please, contact the developers.");a=AnyBalance.requestPost("https://accounts.google.com/ServiceLoginAuth",{osid:"1",_utf8:"☃",bgresponse:"js_disabled",pstMsg:"0",dnConn:"",checkConnection:"",checkedDomains:"youtube",signIn:"Войти",rmShown:"1",
Email:b.login,Passwd:b.password,GALX:a,PersistentCookie:"yes"},g_headers);if(b=getParam(a,null,null,/<form[^>]+id="challenge"[^>]*>([\s\S]*?)<\/form>/i)){if(7<=AnyBalance.getLevel()){AnyBalance.trace("Trying to get code...");var c=getParam(a,null,null,/<input[^>]+name="Pin"[^>]*placeholder="([^"]*)/i,null,html_entity_decode),c=AnyBalance.retrieveCode(c||"Please, enter code from Authentificator");AnyBalance.trace("Got code: "+c)}if(!isset(c))throw new AnyBalance.Error("Two-factor authorization is enabled. Just now we can`t deal with this. Login attempt has failed.");
b=createFormParams(b);b.Pin=c;a=AnyBalance.requestPost("https://accounts.google.com/signin/challenge",b,addHeaders({Referer:"https://accounts.google.com/ServiceLoginAuth"}))}isLoginSuccesful(a);if(b=getElement(a,/<form[^>]+action="SmsAuthInterstitial"[^>]*>/i))AnyBalance.trace("Needs 2-factor parameters review, skipping it to view later"),c=createFormParams(a,function(a,b,c,d){if(!/type="submit"/i.test(b)||"remind"==c)return d}),a=AnyBalance.requestPost("https://accounts.google.com/SmsAuthInterstitial",
c,addHeaders({Referer:AnyBalance.getLastUrl()}));isLoginSuccesful(a);AnyBalance.saveCookies();AnyBalance.saveData();return a};
