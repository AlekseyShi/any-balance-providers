var g_headers={Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8","Accept-Language":"ru,en-US;q=0.8,en;q=0.6,uk;q=0.4",Connection:"keep-alive",Origin:"https://online.oschadbank.ua","User-Agent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/47.0.2526.111 Safari/537.36"},baseurl="https://online.oschadbank.ua/",gDataJson;
function login(b,a){AnyBalance.setDefaultCharset("utf-8");checkEmpty(b.login,"Введіть логін!");checkEmpty(b.password,"Введіть пароль!");AnyBalance.requestGet(baseurl+"wb/",g_headers);a=AnyBalance.requestGet(baseurl+"wb/api/v2/session",addHeaders({Referer:baseurl+"wb/","X-Requested-With":"XMLHttpRequest"}));a=getJson(a);if("authenticated"!=a.status){if(a=AnyBalance.requestPost(baseurl+"wb/api/v2/session",JSON.stringify({login:b.login,password:b.password,captcha:"",_error:null}),addHeaders({Referer:baseurl+
"wb/","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"})),a=getJson(a),"authenticated"!=a.status&&a._error)throw new AnyBalance.Error("INVALID_LOGIN_OR_PASSWORD"==a._error.code?"Невірний логін або пароль":a._error.code,null,/INVALID_LOGIN_OR_PASSWORD/i.test(a._error.code));}else AnyBalance.trace("Используем существующую сессию");__setLoginSuccessful();return a}
function processProfile(b,a){b=getProductJson();for(var e=0;e<b.length;++e){var c=b[e];if(c.owner){a.profile={};getParam(c.owner.fullName,a.profile,"profile.fio");getParam(c.owner.itn,a.profile,"profile.itn");break}}}function processCards(b,a){b=getProductJson("card");AnyBalance.trace("Найдено карт: "+b.length);a.cards=[];for(var e=0;e<b.length;++e){var c=b[e],d=c.number,d={__id:c.id,__name:d,num:d};__shouldProcess("cards",d)&&processCard(c,d);a.cards.push(d)}}
function processCard(b,a){getParam(b.balances.available.value,a,"cards.balance",null,null,parseBalance);getParam(b.balances.full_crlimit.value,a,"cards.maxlimit",null,null,parseBalance);getParam(b.card.expiryDate+"",a,"cards.till",null,null,parseDate);getParam(b.balances.total_due.value,a,"cards.debt",null,null,parseBalance);getParam(b.balances["06"].value,a,"cards.mz",null,null,parseBalance);getParam(b.card.accountNumber,a,"cards.rr");getParam(b.balances.available.currency,a,["cards.currency","cards.balance",
"cards.maxlimit","cards.debt","cards.mz"]);getParam(b.number,a,"cards.cardNumber");"undefined"!=typeof processCardTransactions&&processCardTransactions(b,a)}function processAccounts(b,a){b=getProductJson("cardAccount");AnyBalance.trace("Найдено счетов: "+b.length);a.accounts=[];for(var e=0;e<b.length;++e){var c=b[e],d=c.number,d={__id:c.id,__name:d,num:d};__shouldProcess("accounts",d)&&processAccount(c,d);a.accounts.push(d)}}
function processAccount(b,a){getParam(b.balances.available.value,a,"accounts.balance",null,null,parseBalance);getParam(b.balances.full_crlimit.value,a,"accounts.maxlimit",null,null,parseBalance);getParam(b.balances.total_due.value,a,"accounts.debt",null,null,parseBalance);getParam(b.balances["06"].value,a,"accounts.mz",null,null,parseBalance);getParam(b.cardAccount.accountNumber,a,"accounts.rr");getParam(b.balances.available.currency,a,["accounts.currency","accounts.balance","accounts.maxlimit","accounts.debt",
"accounts.mz"]);"undefined"!=typeof processAccountTransactions&&processAccountTransactions(b,a)}function getProductJson(b){if(gDataJson)a=gDataJson;else var a=AnyBalance.requestGet(baseurl+"wb/api/v2/contracts?system=W4C",addHeaders({"X-Requested-With":"XMLHttpRequest"})),a=gDataJson=getJson(a);return isset(b)?a.filter(function(a){return a.type==b}):a}function sortByKey(b,a){return b.sort(function(b,c){b=b[a];c=c[a];return b>c?-1:b<c?1:0})};
