var g_headers={Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8","User-Agent":"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/47.0.2526.111 Safari/537.36"},g_Xml_Headers={Accept:"application/xml, text/xml, */*; q=0.01","X-Requested-With":"XMLHttpRequest","Wicket-Ajax":"true","Wicket-Ajax-BaseURL":"main","Wicket-FocusedElementId":"id19",Origin:"https://online.absolutbank.ru"},baseurl="https://online.absolutbank.ru/app/";
function login(b,c){AnyBalance.setDefaultCharset("utf-8");checkEmpty(b.login,"Введите логин!");checkEmpty(b.password,"Введите пароль!");var a=AnyBalance.requestGet(baseurl+"main?main=priv",g_headers);if(!a||400<AnyBalance.getLastStatusCode())throw AnyBalance.trace(a),new AnyBalance.Error("Ошибка при подключении к сайту провайдера! Попробуйте обновить данные позже.");if(!/logout/i.test(a)){var d=findWicketActions(a),e=[],f=getParam(a,null,null,/<input[^>]*name="password"[^>]*id="([^"]+)/i),h=getParam(a,
null,null,/<input[^>]*name="login"[^>]*id="([^"]+)/i),k=getParam(a,null,null,/<a[^>]*class="button[^>]*id="([^"]+)/i);d.forEach(function(a,b,c){a=getJson(a);b=(a.u||"").replace(/^.\/main/,"main").replace(/;jsessionid[^?]+/i,"");switch(a.c){case h:e[0]=b;break;case f:e[1]=b;break;case k:e[2]=b}});d=[{login:b.login},{password:b.password}];d[2]=joinObjects(d[0],d[1]);for(var g=0;g<e.length;g++)a=AnyBalance.requestPost(baseurl+e[g],d[g],addHeaders(g_Xml_Headers));if(!/logout/i.test(a)){if(d=AB.getParam(a,
null,null,/"feedbackPanelERROR"[^>]*>([\s\S]*?)<\//i,AB.replaceTagsAndSpaces))throw new AnyBalance.Error(d,null,/Неверно указан/i.test(d));AnyBalance.trace(a);throw new AnyBalance.Error("Не удалось зайти в личный кабинет. Сайт изменен?");}__setLoginSuccessful()}return a}
function processProfile(b,c){isAvailable("profile")&&(b=requestGetWicketAction(b,/<span[^>]+class="link" id="(id[^"]+)/i),c.profile={},getParam(b,c.profile,"profile.fio",/ФИО((?:[\s\S]*?<\/div[^>]*>){2})/i,replaceTagsAndSpaces),getParam(b,c.profile,"profile.birthday",/Дата рождения((?:[\s\S]*?<\/div[^>]*>){2})/i,replaceTagsAndSpaces),getParam(b,c.profile,"profile.phone",/Телефон((?:[\s\S]*?<\/div[^>]*>){2})/i,replaceTagsAndSpaces),getParam(b,c.profile,"profile.adress",/Адрес регистрации((?:[\s\S]*?<\/div[^>]*>){2})/i,
replaceTagsAndSpaces),getParam(b,c.profile,"profile.adressHome",/Домашний адрес((?:[\s\S]*?<\/div[^>]*>){2})/i,replaceTagsAndSpaces))}function findWicketActions(b){b=sumParam(b,null,null,/Wicket.Ajax.ajax\((\{[\s\S]*?\})\);/ig)||[];AnyBalance.trace("Found "+b.length+" Wicket-ajax actions");return b}function findExactWickeAction(b,c){if(b)for(var a=0;a<b.length;a++){var d=getJson(b[a]),e=(d.u||"").replace(/^.\/main/,"main").replace(/;jsessionid[^?]+/i,"");if(d.c===c)return e}}
function requestGetWicketAction(b,c){var a=getParam(b,null,null,c);if(!a)throw new AnyBalance.Error("Не нашли wicketId!");var d=findWicketActions(b),a=findExactWickeAction(d,a);return AnyBalance.requestGet(baseurl+a+"&_="+(new Date).getTime(),addHeaders(g_Xml_Headers))}
function checkForRedirect(b){/<redirect>/i.test(b)&&((b=getParam(b,null,null,/main;[^\]]+/i))||AnyBalance.trace("Запрошен редиретк, но ссылка на него не найдена, сайт изменен?"),b=AnyBalance.requestGet(baseurl+b,g_headers));return b}
function processCards(b,c){if(isAvailable("cards")){b=AnyBalance.requestGet(baseurl+"main?main=priv",g_headers);b=requestGetWicketAction(b,/wicket.event.add\([^"]*?"load"[\s\S]*?"c":"([^"]*)/i);b=requestGetWicketAction(b,/<div[^>]+class="inner"[^>]+id="(id[^"]+)"/i);var a=getElements(b,/<div[^>]+class=['"]card inner['"][^>]*>/ig);AnyBalance.trace("Найдено карт: "+a.length);c.cards=[];for(var d=0;d<a.length;++d){var e=getParam(a[d],null,null,/<small[^>]+class="gray"[^>]*>([\s\S]*?)<\//i,replaceTagsAndSpaces),
f=getParam(a[d],null,null,/"card-name"[^>]*>([\s\S]*?)<\//i,replaceTagsAndSpaces),e={__id:e,__name:f+" "+e};__shouldProcess("cards",e)&&processCard(a[d],e,b);c.cards.push(e)}}}
function processCard(b,c,a){getParam(b,c,"cards.balance",/class="amount"[^>]*>([\s\S]*?)<\/div>/i,replaceTagsAndSpaces,parseBalance);getParam(b,c,["cards.currency","cards"],/class="amount"[^>]*>([\s\S]*?)<\/div>/i,replaceTagsAndSpaces,parseCurrency);a=requestGetWicketAction(a,/<div[^>]+class="card inner"[^>]+id="(id[^"]+)"/i);getParam(a,c,"cards.limit",/Кредитный лимит((?:[\s\S]*?<\/div[^>]*>){2})/i,replaceTagsAndSpaces,parseBalance);getParam(a,c,"cards.debt",/Общая задолженность((?:[\s\S]*?<\/div[^>]*>){2})/i,
replaceTagsAndSpaces,parseBalance);getParam(a,c,"cards.ovedraft",/Текущий овердрафт((?:[\s\S]*?<\/div[^>]*>){2})/i,replaceTagsAndSpaces,parseBalance);getParam(a,c,"cards.ovedraft_pcts",/Сумма начисленных процентов по овердрафту((?:[\s\S]*?<\/div[^>]*>){2})/i,replaceTagsAndSpaces,parseBalance);getParam(a,c,"cards.ovedraft_overdue",/Просроченный овердрафт((?:[\s\S]*?<\/div[^>]*>){2})/i,replaceTagsAndSpaces,parseBalance);getParam(a,c,"cards.overlimit",/Сверхлимитная задолженность((?:[\s\S]*?<\/div[^>]*>){2})/i,
replaceTagsAndSpaces,parseBalance);getParam(a,c,"cards.commissions",/Cумма комиссий((?:[\s\S]*?<\/div[^>]*>){2})/i,replaceTagsAndSpaces,parseBalance);getParam(a,c,"cards.penalty",/Сумма штрафов((?:[\s\S]*?<\/div[^>]*>){2})/i,replaceTagsAndSpaces,parseBalance);getParam(a,c,"cards.billing_date",/Расчетная дата((?:[\s\S]*?<\/div[^>]*>){2})/i,replaceTagsAndSpaces,parseBalance);getParam(a,c,"cards.minpay",/Минимальный платеж((?:[\s\S]*?<\/div[^>]*>){2})/i,replaceTagsAndSpaces,parseBalance);getParam(a,
c,"cards.minpay_overdue",/в том числе просроченные минимальные платежи((?:[\s\S]*?<\/div[^>]*>){2})/i,replaceTagsAndSpaces,parseBalance);getParam(a,c,"cards.till",/Срок действия((?:[\s\S]*?<\/div[^>]*>){2})/i,replaceTagsAndSpaces,parseDate);getParam(a,c,"cards.holderName",/Имя владельца((?:[\s\S]*?<\/div[^>]*>){2})/i,replaceTagsAndSpaces);getParam(a,c,"cards.status",/Статус карты((?:[\s\S]*?<\/div[^>]*>){2})/i,replaceTagsAndSpaces);"undefined"!=typeof processCardTransactions&&processCardTransactions(a,
c)}
function processAccounts(b,c){if(isAvailable("accounts")){b=AnyBalance.requestGet(baseurl+"main?main=priv",g_headers);b=requestGetWicketAction(b,/wicket.event.add\([^"]*?"load"[\s\S]*?"c":"([^"]*)/i);b=requestGetWicketAction(b,/<div[^>]+class="inner"[^>]+id="(id[^"]+)"/i);var a=getElements(b,/<div[^>]+class=['"]account inner single-account['"][^>]*>/ig);AnyBalance.trace("Найдено счетов: "+a.length);c.accounts=[];for(var d=0;d<a.length;++d){var e=requestGetWicketAction(a[d]+b,/id="(id[^"]+)"/i),f=
{__id:getParam(e,null,null,/№(?:[^>]*>)?(\d{20})/i,replaceTagsAndSpaces),__name:getParam(e,null,null,/class="dashed active"[^>]*>([\s\S]*?)<\/span>/i,replaceTagsAndSpaces)};__shouldProcess("accounts",f)&&processAccount(e,f);c.accounts.push(f)}}}
function processAccount(b,c){getParam(b,c,"accounts.balance",/class="[^"]*amounts"[^>]*>([\s\S]*?)<\/div>/i,replaceTagsAndSpaces,parseBalance);getParam(b,c,["accounts.currency","accounts"],/class="[^"]*amounts"[^>]*>([\s\S]*?)<\/div>/i,replaceTagsAndSpaces,parseCurrency);"undefined"!=typeof processAccountTransactions&&processAccountTransactions(b,c)}
function processCredits(b,c){if(isAvailable("credits")){b=AnyBalance.requestGet(baseurl+"main?main=priv",g_headers);b=requestGetWicketAction(b,/wicket.event.add\([^"]*?"load"[\s\S]*?"c":"([^"]*)/i);b=requestGetWicketAction(b,/<div[^>]+class="inner"[^>]+id="(id[^"]+)"(?:[^>]*>){3,7}\s*Кредиты/i);var a=getElements(b,/<div[^>]+class=['"]account inner[^>]*>/ig);AnyBalance.trace("Найдено кредитов: "+a.length);c.credits=[];for(var d=0;d<a.length;++d){var e=getParam(a[d],null,null,/<span[^>]*class=['"]index['"](?:[^>]*>){2}([\s\S]*?)<\/div>/i,
replaceTagsAndSpaces),e={__id:e,__name:e};__shouldProcess("credits",e)&&processCredit(a[d],e,b);c.credits.push(e)}}}
function processCredit(b,c,a){getParam(b,c,"credits.balance",/class="sum"[^>]*>([\s\S]*?)<\/div>/i,replaceTagsAndSpaces,parseBalance);getParam(b,c,["credits.currency","credits"],/class="sum"[^>]*>([\s\S]*?)<\/div>/i,replaceTagsAndSpaces,parseCurrency);getParam(b,c,"credits.minpay_till",/К оплате([\s\S]*?)<\//i,replaceTagsAndSpaces,parseDate);getParam(b,c,"credits.minpay",/К оплате[\s\S]*?class="sum"[^>]*>([\s\S]*?)<\/div>/i,replaceTagsAndSpaces,parseBalance);a=requestGetWicketAction(a,/<div[^>]+class="account inner[^>]+id="(id[^"]+)"/i);
getParam(a,c,"credits.debt_main",/Общая задолженность(?:[^>]*>){3}([\s\S]*?)<\/span>/i,replaceTagsAndSpaces,parseBalance);getParam(a,c,"credits.principal_debt",/Сумма основного долга(?:[^>]*>){3}([\s\S]*?)<\/span>/i,replaceTagsAndSpaces,parseBalance);getParam(a,c,"credits.pct_sum",/Cумма начисленных процентов(?:[^>]*>){3}([\s\S]*?)<\/span>/i,replaceTagsAndSpaces,parseBalance);getParam(a,c,"credits.debt_expired",/Сумма просроченного основного долга(?:[^>]*>){3}([\s\S]*?)<\/span>/i,replaceTagsAndSpaces,
parseBalance);getParam(a,c,"credits.pct_expired",/Сумма просроченных процентов(?:[^>]*>){3}([\s\S]*?)<\/span>/i,replaceTagsAndSpaces,parseBalance);getParam(a,c,"credits.penalty",/Штрафы(?:[^>]*>){3}([\s\S]*?)<\/span>/i,replaceTagsAndSpaces,parseBalance);getParam(a,c,"credits.minpay_main_debt",/К оплате[\s\S]*?Сумма основного долга([\s\S]*?)<\/span>/i,replaceTagsAndSpaces,parseBalance);getParam(a,c,"credits.minpay_pct",/К оплате[\s\S]*?Сумма процентов([\s\S]*?)<\/span>/i,replaceTagsAndSpaces,parseBalance);
getParam(a,c,"credits.minpay_others",/К оплате[\s\S]*?Другие комиссии([\s\S]*?)<\/span>/i,replaceTagsAndSpaces,parseBalance);getParam(a,c,"credits.minpay_penalty",/К оплате[\s\S]*?Пеня за([\s\S]*?)<\/span>/i,replaceTagsAndSpaces,parseBalance);getParam(a,c,"credits.minpay_pct_expired",/К оплате[\s\S]*?Сумма просроченных процентов([\s\S]*?)<\/span>/i,replaceTagsAndSpaces,parseBalance);getParam(a,c,"credits.minpay_debt_expried",/К оплате[\s\S]*?Сумма просроченного основного долга([\s\S]*?)<\/span>/i,
replaceTagsAndSpaces,parseBalance);"undefined"!=typeof processCreditSchedule&&processCreditSchedule(a,c)};
