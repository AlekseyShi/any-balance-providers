var g_headers={Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8","Accept-Charset":"windows-1251,utf-8;q=0.7,*;q=0.3","Accept-Language":"ru-RU,ru;q=0.8,en-US;q=0.6,en;q=0.4",Connection:"keep-alive","User-Agent":"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.64 Safari/537.11"},g_baseurl="https://client.mdmbank.ru";
function login(){var a=AnyBalance.getPreferences();checkEmpty(a.login,"Введите логин!");checkEmpty(a.password,"Введите пароль!");var b=AnyBalance.requestGet(g_baseurl+"/index.asp",addHeaders({Referer:g_baseurl+"/index.asp"}));if(!b||400<AnyBalance.getLastStatusCode())throw AnyBalance.trace(b),new AnyBalance.Error("Ошибка интернет-банка. Попробуйте обновить данные позже.");/logout\.asp/i.test(b)?AnyBalance.trace("Уже залогинены, отлично."):b=AnyBalance.requestPost(g_baseurl+"/login.asp",{unc:a.login,
pin:a.password},addHeaders({Referer:g_baseurl+"/login.asp"}));if(!/logout\.asp/i.test(b)&&(a=getElement(b,/<form[^>]+id="ib-loginotp-form"[^>]*>/i))){AnyBalance.trace("Требуется SMS-подтверждение входа. Запрашиваем его.");var c=getParam(a,null,null,/<label[^>]*for="password"[^>]*>([\s\S]*?)<\/label>/i,[replaceTagsAndSpaces,/и нажмите.*/i,""]),b=AnyBalance.requestPost(g_baseurl+"/ajax2.asp",{ajaxmode:"otpget"},addHeaders({Referer:g_baseurl+"/loginotp.asp","X-Requested-With":"XMLHttpRequest"}));if("0"!=
getJson(b).result)throw AnyBalance.trace(b),new AnyBalance.Error("Не удалось потребовать посылки SMS-подтверждения. Попробуйте ещё раз позже.");b=createFormParams(a,function(a,b,e,g){return"password"==e?AnyBalance.retrieveCode(c||"Пожалуйста, введите код из SMS для подтверждения входа в интернет-банк.\n\nВы можете отключить требование кода на вход в настройках своего интернет банка, чтобы не вводить его каждый раз. Это безопасно, совершение операций всё равно будет требовать ввода одноразового пароля.",
null,{inputType:"number",time:18E4}):g},!0);b=AnyBalance.requestPost(g_baseurl+"/loginotp.asp",b,addHeaders({Referer:g_baseurl+"/loginotp.asp"}))}if(!/logout\.asp/i.test(b)){if(a=getParam(b,null,null,/<div[^>]+class=['"]err['"][^>]*>([\s\S]*?)<\/div>/i,[replaceTagsAndSpaces,/\s*Вам выслан новый.*/i,""]))throw new AnyBalance.Error(a,null,/Неверный логин или пароль/i.test(a));if(a=getParam(b,null,null,/<label[^>]*>((?:[\s\S](?!<\/label>))*RetailWeb.Web.ClientLogin[\s\S]*?)<\/label>/i,replaceTagsAndSpaces))throw new AnyBalance.Error(a,
null,/Неверный логин или пароль/i.test(a));if(a=getParam(b,null,null,/<div id="error-dialog"[^>]*>([\s\S]*?)<\/div>/i,replaceTagsAndSpaces))throw new AnyBalance.Error(a,null,/Неверное имя пользователя или пароль/i.test(a));AnyBalance.trace(b);throw new AnyBalance.Error("Не удалось войти в интернет-банк. Сайт изменен?");}__setLoginSuccessful();return b}
function processCards(a,b){if(AnyBalance.isAvailable("cards")){a=AnyBalance.requestGet(g_baseurl+"/cards.asp",addHeaders({Referer:g_baseurl+"/index.asp"}));var c=getElement(a,/<table[^>]*card-table[^>]*>/i);if(c){c=getElements(c,[/<tr[^>]*>/ig,/<td[^>]*>/i]);AnyBalance.trace("Найдено "+c.length+" карт");b.cards=[];for(var d=0;d<c.length;d++){var f=c[d],e=getParam(f,null,null,/<a[^>]+href="[^"]*card-statement[^>]*>([\s\S]*?)<\/a>/i,replaceTagsAndSpaces),g=getParam(f,null,null,/<td[^>]+card-currency[^>]*>([\s\S]*?)<\/td>/i,
replaceTagsAndSpaces),e={__id:e,__name:e+" "+g,num:e};__shouldProcess("cards",e)&&processCard(f,e);b.cards.push(e)}}else/На данный момент у Вас нет[^<]*карт/i.test(a)?AnyBalance.trace("Нет ни одной карты"):(AnyBalance.trace(a),AnyBalance.trace("Не удалось найти карты! Сайт изменен?"))}}
function processCard(a,b){AnyBalance.trace("Обрабатываем карту "+b.__name);getParam(a,b,"cards.currency cards.balance cards.limit cards.blocked cards.available cards.debt_main cards.debt_due cards.debt_pct cards.debt_peni cards.debt_comission cards.minpay cards.debt cards.transactions.sum_account".split(" "),/<td[^>]+class="card-currency"[^>]*>([\s\S]*?)<\/td>/i,replaceTagsAndSpaces);getParam(a,b,"cards.balance",/(?:[\s\S]*?<td[^>]*>){6}([\s\S]*?)<\/td>/i,replaceTagsAndSpaces,parseBalance);getParam(a,
b,"cards.blocked",/(?:[\s\S]*?<td[^>]*>){4}([\s\S]*?)<\/td>/i,replaceTagsAndSpaces,parseBalance);getParam(a,b,"cards.limit",/(?:[\s\S]*?<td[^>]*>){5}([\s\S]*?)<\/td>/i,replaceTagsAndSpaces,parseBalance);getParam(a,b,"cards.till",/(?:[\s\S]*?<td[^>]*>){3}([\s\S]*?)<\/td>/i,replaceTagsAndSpaces,parseDate);var c=getParam(a,null,null,/<a[^>]+href="([^"]*card-statement[^"]*)"[^>]*>/i,replaceHtmlEntities);AnyBalance.isAvailable("cards.available","cards.debt_main","cards.debt_due","cards.debt_pct","cards.debt_peni",
"cards.debt_comission","cards.minpay","cards.debt","cards.minpay_till","cards.transactions")&&(html=AnyBalance.requestGet(joinUrl(g_baseurl,c),addHeaders({Referer:g_baseurl+"/cards.asp"})),getParam(html,b,"cards.available",/<td[^>]*>\s*Доступные средства[\s\S]*?<td[^>]*>([\s\S]*?)<\/td>/,replaceTagsAndSpaces,parseBalance),getParam(html,b,"cards.debt_main",/Сумма основной задолженности[\s\S]*?<td[^>]*>([\s\S]*?)<\/td>/,replaceTagsAndSpaces,parseBalance),getParam(html,b,"cards.debt_due",/Сумма просроченной задолженности[\s\S]*?<td[^>]*>([\s\S]*?)<\/td>/,
replaceTagsAndSpaces,parseBalance),getParam(html,b,"cards.debt_pct",/Начисленные проценты[\s\S]*?<td[^>]*>([\s\S]*?)<\/td>/,replaceTagsAndSpaces,parseBalance),getParam(html,b,"cards.debt_peni",/Просроченные проценты, штрафы, пени[\s\S]*?<td[^>]*>([\s\S]*?)<\/td>/,replaceTagsAndSpaces,parseBalance),getParam(html,b,"cards.debt_comission",/Комиссионная задолженность[\s\S]*?<td[^>]*>([\s\S]*?)<\/td>/,replaceTagsAndSpaces,parseBalance),getParam(html,b,"cards.minpay",/Минимальная сумма взноса[\s\S]*?<td[^>]*>([\s\S]*?)<\/td>/,
replaceTagsAndSpaces,parseBalance),getParam(html,b,"cards.minpay_till",/Минимальная сумма взноса(?:[\s\S]*?<td[^>]*>){2}([\s\S]*?)<\/tr>/,replaceTagsAndSpaces,parseDate),getParam(html,b,"cards.debt",/Сумма полной задолженности[\s\S]*?<td[^>]*>([\s\S]*?)<\/td>/,replaceTagsAndSpaces,parseBalance),getParam(html,b,"cards.overlimit",/Сумма использованных сверхлимитных средств[\s\S]*?<td[^>]*>([\s\S]*?)<\/td>/,replaceTagsAndSpaces,parseBalance),getParam(html,b,"cards.accnum",/Р\/с([^<]*)/i,replaceTagsAndSpaces),
AnyBalance.isAvailable("cards.transactions")&&processCardTransactions(html,b));return b}var replaceSign=[/<td[^>]+red[^>]*>/i,"-",replaceTagsAndSpaces];
function processCardTransactions(a,b){var c={date:{re:/Дата проведения/i,result_func:parseDateSilent},date_done:{re:/Дата отражения/i,result_func:parseDateSilent},descr:{re:/Детали операции/i,result_func:null},place:{re:/Город и страна/i,result_func:null},sum:{re:/Сумма операции/i,result_func:parseBalanceSilent},currency:{re:/Валюта операции/i,result_func:null,result_name:["currency","sum"]},fee:{re:/Комиссия Банка/i,result_func:parseBalanceSilent},sum_in:{re:/Сумма зачисления/i,result_name:"sum_done",
result_sum:!0,result_replace:replaceSign,result_func:parseBalanceSilent},sum_out:{re:/Сумма зачисления/i,result_name:"sum_done",result_sum:!0,result_replace:replaceSign,result_func:parseBalanceSilent}},d=new Date,f=new Date(d.getFullYear()-5,d.getMonth(),1);a=AnyBalance.requestPost(g_baseurl+"/card-statement.asp",{id:getParam(a,null,null,/<input[^>]+name="id"[^>]*value="([^"]*)/i,replaceHtmlEntities),fromdate:fmtDate(f),todate:fmtDate(d)},addHeaders({Referer:g_baseurl+"/card-statement.asp"}));if(d=
getElement(a,/<table[^>]+class="card-table"[^>]*>/i)){b.transactions=[];var e;processTable(d,b.transactions,"cards.transactions.",c,function(a){(a=getParam(a,null,null,/\d{4,6}x{6,8}\d{4}/i))&&(e=a)},function(a,b){getParam(e,a,b+"card")})}else AnyBalance.trace(a),AnyBalance.trace("Не удалось найти таблицу транзакций по карте!")}function initCols(a,b){for(var c={},d=0;d<b.length;d++){var f=b[d],e;for(e in a)a[e].re.test(f)&&(c[e]=d)}return c}
function fillColsResult(a,b,c,d,f){function e(a,b){return isset(a)?a:b}f=f||"";var g=replaceTagsAndSpaces,l=parseBalance,n=aggregate_sum,k;for(k in a){var h=a[k];if(isset(b[k])){var p=c[b[k]],m=e(h.result_name,k);if(isArray(m)){for(var r=[],q=0;q<m.length;q++)r.push(f+m[q]);m=r}else m=f+m;h.result_process?h.result_process(f,p,d):h.result_sum?(h.result_re&&(h.result_re.lastIndex=0),sumParam(p,d,m,h.result_re,e(h.result_replace,g),e(h.result_func,l),e(h.result_aggregate,n))):getParam(p,d,m,h.result_re,
e(h.result_replace,g),e(h.result_func,l))}}}
function processCredits(a,b){if(AnyBalance.isAvailable("credits")){a=AnyBalance.requestGet(g_baseurl+"/loans.asp",addHeaders({Referer:g_baseurl+"/index.asp"}));var c=getElement(a,/<table[^>]*card-table[^>]*>/i);if(c){c=getElements(c,[/<tr[^>]*>/ig,/<td[^>]*>/i]);AnyBalance.trace("Найдено "+c.length+" кредитов");b.credits=[];for(var d=0;d<c.length;d++){var f=c[d],e=getParam(f,null,null,/<a[^>]+href=["'][^"']*loan-statement.asp\?id=([^'"&]*)/i,null,html_entity_decode),g=getParam(f,null,null,/<a[^>]+href=["'][^"']*loan-statement.asp[^>]*>([\s\S]*?)<\/a>/i,
replaceTagsAndSpaces,html_entity_decode),l=getParam(f,null,null,/№\s*(\S+)/i),e={__id:e,__name:g,agreement:l};__shouldProcess("credits",e)&&processCredit(f,e);b.credits.push(e)}}else/На данный момент у Вас нет[^<]*кредитов/i.test(a)?AnyBalance.trace("Нет ни одного кредита"):(AnyBalance.trace(a),AnyBalance.trace("Не удалось найти кредиты! Сайт изменен?"))}}
function processCredit(a,b){AnyBalance.trace("Обрабатываем кредит "+b.__name);getParam(a,b,["credits.currency","credits.balance","credits.minpay","credits.balance_acc"],/(?:[\s\S]*?<td[^>]*>){2}([\s\S]*?)<\/td>/i,replaceTagsAndSpaces);getParam(a,b,"credits.balance",/(?:[\s\S]*?<td[^>]*>){7}([\s\S]*?)<\/td>/i,replaceTagsAndSpaces,parseBalance);getParam(a,b,"credits.minpay",/(?:[\s\S]*?<td[^>]*>){6}([\s\S]*?)<\/td>/i,replaceTagsAndSpaces,parseBalance);getParam(a,b,"credits.minpay_till",/(?:[\s\S]*?<td[^>]*>){5}([\s\S]*?)<\/td>/i,
replaceTagsAndSpaces,parseDate);getParam(a,b,"credits.date_end",/(?:[\s\S]*?<td[^>]*>){4}([\s\S]*?)<\/td>/i,replaceTagsAndSpaces,parseDate);getParam(a,b,"credits.date_start",/(?:[\s\S]*?<td[^>]*>){3}([\s\S]*?)<\/td>/i,replaceTagsAndSpaces,parseDate);var c=getParam(a,null,null,/<a[^>]+href=["']([^"']*loan-statement[^'"]*)/i,replaceHtmlEntities);AnyBalance.isAvailable("credits.transactions","credits.accnum","credits.pct","credita.balance_acc","credits.schedule")&&(c=AnyBalance.requestGet(joinUrl(g_baseurl,
c),addHeaders({Referer:g_baseurl+"/credits.asp"})),getParam(c,b,"credits.pct",/Процентная ставка[\s\S]*?<h1[^>]*>([\s\S]*?)<\/h1>/,replaceTagsAndSpaces,parseBalance),getParam(c,b,"credits.accnum",/Счет погашения[\s\S]*?<h1[^>]*>([\s\S]*?)<\/h1>/,replaceTagsAndSpaces),getParam(c,b,"credita.balance_acc",/Остаток на счете погашения[\s\S]*?<h1[^>]*>([\s\S]*?)<\/h1>/,replaceTagsAndSpaces,parseBalance),AnyBalance.isAvailable("credits.schedule")&&processCreditSchedule(c,b),AnyBalance.isAvailable("credits.transactions")&&
processCreditTransactions(c,b));return b}function processTable(a,b,c,d,f,e){a=getElements(a,/<tr[^>]*>/ig);for(var g,l,n=0;n<a.length;n++){var k=a[n],h=getElements(k,/<td[^>]*>/ig);0==h.length?(g=getElements(k,/<th[^>]*>/ig),l=g.length,g=initCols(d,g)):h.length==l?(k={},fillColsResult(d,g,h,k,c),e&&e(k,c),b.push(k)):f&&f(k,h)}}
function processCreditSchedule(a,b){var c={date:{re:/Дата платежа/i,result_func:parseDateSilent},loan:{re:/Ссуда/i,result_process:function(a,b,c){b=replaceAll(b,replaceTagsAndSpaces);getParam(b,c,a+"debt_main",/([^\/]*)/i,null,parseBalanceSilent);getParam(b,c,a+"debt_pct",/[^\/]*\/([^\/]*)/i,null,parseBalanceSilent);getParam(b,c,a+"debt_fee",/(?:[^\/]*\/){2}([^\/]*)/i,null,parseBalanceSilent)}},sum:{re:/Сумма/i,result_func:parseBalanceSilent},balance:{re:/Остаток/i,result_func:parseBalanceSilent},
status:{re:/Состояние/i,result_func:null}},d=getParam(a,null,null,/График возврата кредита:[\s\S]*?<table[^>]*card-table[^>]*>([\s\S]*?)<\/table>/i);d?(b.schedule=[],processTable(d,b.schedule,"credits.schedule.",c)):(AnyBalance.trace(a),AnyBalance.trace("Не найден график возврата кредита"))}
function processCreditTransactions(a,b){var c={date:{re:/Дата/i,result_func:parseDateSilent},descr:{re:/Операция/i,result_func:null},sum:{re:/Сумма/i,result_func:parseBalanceSilent},currency:{re:/Валюта/i,result_func:null}},d=getParam(a,null,null,/Выписка по счету:[\s\S]*?<table[^>]*card-table[^>]*>([\s\S]*?)<\/table>/i);d?(b.transactions=[],processTable(d,b.transactions,"credits.transactions.",c)):(AnyBalance.trace(a),AnyBalance.trace("Не найдена выписка по кредитному счету"))}
function processInfo(a,b){var c=b.info={};getParam(a,c,"info.fio",/<span[^>]+id="clientname"[^>]*>([\s\S]*?)<\/span>/i,replaceTagsAndSpaces);AnyBalance.isAvailable("info.fam","info.name","info.pname","info.birth_place","info.birthday","info.inn","info.resident")&&(a=AnyBalance.requestGet(g_baseurl+"/services.asp",addHeaders({Referer:g_baseurl+"/index.asp"})),getParam(a,c,"info.fam",/Фамилия:[\s\S]*?<input[^>]+value="([^"]*)/i,replaceHtmlEntities),getParam(a,c,"info.name",/Имя:[\s\S]*?<input[^>]+value="([^"]*)/i,
replaceHtmlEntities),getParam(a,c,"info.pname",/Отчество[\s\S]*?<input[^>]+value="([^"]*)/i,replaceHtmlEntities),getParam(a,c,"info.birth_place",/Место рождения[\s\S]*?<input[^>]+value="([^"]*)/i,replaceHtmlEntities),getParam(a,c,"info.birthday",/Дата рождения[\s\S]*?<input[^>]+value="([^"]*)/i,replaceHtmlEntities),getParam(a,c,"info.inn",/ИНН:[\s\S]*?<input[^>]+value="([^"]*)/i,replaceHtmlEntities),getParam(a,c,"info.resident",/Резидентность:[\s\S]*?<b[^>]*>([\s\S]*?)<\/b>/i,replaceTagsAndSpaces,
function(a){return/да/i.test(a)}));if(AnyBalance.isAvailable("info.contacts")){a=AnyBalance.requestGet(g_baseurl+"/services-contacts.asp",addHeaders({Referer:g_baseurl+"/services.asp"}));var d={type:{re:/Тип/i,result_func:function(a){return/мобил/i.test(a)?"mobile":/эл/i.test(a)?"email":/домаш/i.test(a)?"home":/рабоч/i.test(a)?"work":a}},contact:{re:/Контакт/i,result_func:null}},f=getElement(a,/<table[^>]+class="card-table"[^>]*>/i);f&&(c.contacts=[],processTable(f,c.contacts,"info.contacts.",d))}}
function processDeposits(a,b){if(AnyBalance.isAvailable("deposits")){a=AnyBalance.requestGet(g_baseurl+"/deposits.asp",addHeaders({Referer:g_baseurl+"/index.asp"}));var c=getElement(a,/<table[^>]*card-table[^>]*>/i);if(c){c=getElements(c,[/<tr[^>]*>/ig,/<td[^>]*>/i]);AnyBalance.trace("Найдено "+c.length+" депозитов");b.deposits=[];for(var d=0;d<c.length;d++){var f=c[d],e=getParam(f,null,null,/<a[^>]+href=["'][^"']*deposit-statement.asp\?id=([^'"&]*)/i,replaceHtmlEntities),g=getParam(f,null,null,/<a[^>]+href=["'][^"']*deposit-statement.asp[^>]*>([\s\S]*?)<\/a>/i,
replaceTagsAndSpaces),l=getParam(g,null,null,/\d{20}/),e={__id:e,__name:g,num:l};__shouldProcess("deposits",e)&&processDeposit(f,e);b.deposits.push(e)}}else/На данный момент у Вас нет[^<]*депозитов/i.test(a)?AnyBalance.trace("Нет ни одного депозита"):(AnyBalance.trace(a),AnyBalance.trace("Не удалось найти депозиты! Сайт изменен?"))}}
function processDeposit(a,b){AnyBalance.trace("Обрабатываем депозит "+b.__name);getParam(a,b,["deposits.currency","deposits.balance","deposits.balance_start","deposits.transactions"],/(?:[\s\S]*?<td[^>]*>){5}([\s\S]*?)<\/td>/i,replaceTagsAndSpaces);getParam(a,b,"deposits.balance",/(?:[\s\S]*?<td[^>]*>){7}([\s\S]*?)<\/td>/i,replaceTagsAndSpaces,parseBalance);getParam(a,b,"credits.balance_start",/(?:[\s\S]*?<td[^>]*>){6}([\s\S]*?)<\/td>/i,replaceTagsAndSpaces,parseBalance);getParam(a,b,"deposits.pct",
/(?:[\s\S]*?<td[^>]*>){4}([\s\S]*?)<\/td>/i,replaceTagsAndSpaces,parseBalance);getParam(a,b,"deposits.date_end",/(?:[\s\S]*?<td[^>]*>){3}([\s\S]*?)<\/td>/i,replaceTagsAndSpaces,parseDate);getParam(a,b,"deposits.date_start",/(?:[\s\S]*?<td[^>]*>){2}([\s\S]*?)<\/td>/i,replaceTagsAndSpaces,parseDate);getParam(a,b,"deposits.name",/<a[^>]+href=["'][^"']*deposit-statement.asp[^>]*>[\s\S]*?<br[^>]*>([\s\S]*?)<\/a>/i,replaceTagsAndSpaces);var c=getParam(a,null,null,/<a[^>]+href=["']([^"']*deposit-statement[^'"]*)/i,
replaceHtmlEntities);AnyBalance.isAvailable("deposits.transactions","deposits.next_pct")&&(c=AnyBalance.requestGet(joinUrl(g_baseurl,c),addHeaders({Referer:g_baseurl+"/credits.asp"})),getParam(c,b,"deposits.next_pct",/Дата следующей уплаты процентов:([^<]*)/,replaceTagsAndSpaces,parseDate),AnyBalance.isAvailable("credits.transactions")&&processDepositsTransactions(c,b));return b}
function processDepositsTransactions(a,b){var c={date:{re:/Дата/i,result_func:parseDateSilent},descr:{re:/Операция/i,result_func:null},sum:{re:/Сумма/i,result_replace:replaceSign,result_func:parseBalanceSilent},currency:{re:/Валюта/i,result_func:null}},d=new Date,f=new Date(d.getFullYear()-5,d.getMonth(),1);a=AnyBalance.requestPost(g_baseurl+"/deposit-statement.asp",{id:getParam(a,null,null,/<input[^>]+name="id"[^>]*value="([^"]*)/i,replaceHtmlEntities),fromdate:fmtDate(f),todate:fmtDate(d)},addHeaders({Referer:g_baseurl+
"/deposit-statement.asp"}));(d=getElement(a,/<table[^>]+card-table[^>]*>/i))?(b.transactions=[],processTable(d,b.transactions,"deposita.transactions.",c)):(AnyBalance.trace(a),AnyBalance.trace("Не удалось найти таблицу транзакций депозита!"))}
function processAccounts(a,b){if(AnyBalance.isAvailable("accounts")){a=AnyBalance.requestGet(g_baseurl+"/accounts.asp",addHeaders({Referer:g_baseurl+"/index.asp"}));var c=getElement(a,/<table[^>]*card-table[^>]*>/i);if(c){c=getElements(c,[/<tr[^>]*>/ig,/<td[^>]*>/i]);AnyBalance.trace("Найдено "+c.length+" счетов");b.accounts=[];for(var d=0;d<c.length;d++){var f=c[d],e=getParam(f,null,null,/<a[^>]+href=["'][^"']*account-statement.asp\?id=([^'"&]*)/i,replaceHtmlEntities),g=getParam(f,null,null,/<a[^>]+href=["'][^"']*account-statement[^>]*>([\s\S]*?)<\/a>/i,
replaceTagsAndSpaces),e={__id:e,__name:g,num:g};__shouldProcess("accounts",e)&&processAccount(f,e);b.accounts.push(e)}}else/На данный момент у Вас нет[^<]*счетов/i.test(a)?AnyBalance.trace("Нет ни одного счета"):(AnyBalance.trace(a),AnyBalance.trace("Не удалось найти счета! Сайт изменен?"))}}
function processAccount(a,b){AnyBalance.trace("Обрабатываем счет "+b.__name);getParam(a,b,["accounts.currency","accounts.balance"],/(?:[\s\S]*?<td[^>]*>){5}([\s\S]*?)<\/td>/i,replaceTagsAndSpaces);getParam(a,b,"accounts.balance",/(?:[\s\S]*?<td[^>]*>){4}([\s\S]*?)<\/td>/i,replaceTagsAndSpaces,parseBalance);getParam(a,b,"accounts.type",/(?:[\s\S]*?<td[^>]*>){3}([\s\S]*?)<\/td>/i,replaceTagsAndSpaces);getParam(a,b,"accounts.status",/(?:[\s\S]*?<td[^>]*>){2}([\s\S]*?)<\/td>/i,replaceTagsAndSpaces);var c=
getParam(a,null,null,/<a[^>]+href=["']([^"']*account-statement[^'"]*)/i,replaceHtmlEntities);AnyBalance.isAvailable("accounts.transactions")&&(c=AnyBalance.requestGet(joinUrl(g_baseurl,c),addHeaders({Referer:g_baseurl+"/accounts.asp"})),AnyBalance.isAvailable("accounts.transactions")&&processAccountTransactions(c,b));return b}
function processAccountTransactions(a,b){var c={date:{re:/Дата/i,result_func:parseDateSilent},descr:{re:/Операция/i,result_func:null},sum:{re:/Сумма/i,result_func:parseBalanceSilent},currency:{re:/Валюта/i,result_func:null}},d=new Date,f=new Date(d.getFullYear()-5,d.getMonth(),1);a=AnyBalance.requestPost(g_baseurl+"/account-statement.asp",{id:getParam(a,null,null,/<input[^>]+name="id"[^>]*value="([^"]*)/i,replaceHtmlEntities),fromdate:fmtDate(f),todate:fmtDate(d)},addHeaders({Referer:g_baseurl+"/account-statement.asp"}));
(d=getParam(a,null,null,/<table[^>]*card-table[^>]*>([\s\S]*?)<\/table>/i))?(b.transactions=[],processTable(d,b.transactions,"accounts.transactions.",c)):(AnyBalance.trace(a),AnyBalance.trace("Не найдена выписка по счету"))};
