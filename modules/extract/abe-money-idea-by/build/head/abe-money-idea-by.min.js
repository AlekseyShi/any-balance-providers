var g_headers={Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8","Accept-Language":"ru-RU,ru;q=0.8,en-US;q=0.6,en;q=0.4",Connection:"keep-alive","User-Agent":"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/48.0.2564.116 Safari/537.36"},baseurl="https://ideabank24.by/";
function login(){var c=AnyBalance.getPreferences();AnyBalance.setDefaultCharset("utf-8");checkEmpty(c.login,"Введите логин!");checkEmpty(c.password,"Введите пароль!");var b=AnyBalance.requestGet(baseurl+"balanceOverviewPage.xhtml",g_headers);if(!b||400<AnyBalance.getLastStatusCode())throw AnyBalance.trace(b),new AnyBalance.Error("Ошибка при подключении к сайту интернет-банка! Попробуйте обновить данные позже.");/logout/i.test(b)?AnyBalance.trace("Уже залогинены, используем существующую сессию"):(b=
getElement(b,/<form[^>]+formLogin[^>]*>/i),b=createFormParams(b,function(a,b,f,g){return"formLogin:loginInput"==f?c.login:"formLogin:passwordInput"==f?c.password:g}),b["formLogin:loginBtn"]="",b=AnyBalance.requestPost(baseurl+"loginPage.xhtml",b,addHeaders({Referer:baseurl})));if(!/logout/i.test(b)){var a=getParam(b,null,null,/<span[^>]+error-summary[^>]*>([\s\S]*?)<\/span>/i,replaceTagsAndSpaces);if(a)throw new AnyBalance.Error(a,null,/(Неверный пароль|не зарегистрирован)/i.test(a));AnyBalance.trace(b);
throw new AnyBalance.Error("Не удалось зайти в интернет-банк. Сайт изменен?");}__setLoginSuccessful();return b}
function processAccounts(c,b){if(AnyBalance.isAvailable("accounts")){var a=getElement(c,/<div[^>]+mainForm:j_idt38_content[^>]*>/i),a=getElements(a,/<li[^>]+content-section[^>]*>/ig);if(a.length){AnyBalance.trace("Найдено счетов: "+a.length);b.accounts=[];for(var d=0;d<a.length;d++){var e=getParam(a[d],null,null,/Счет:(?:[^>]*>){4}([\s\S]*?)<\//i,replaceTagsAndSpaces),f=getParam(a[d],null,null,/договор[^\d]*(\d+)/i,replaceTagsAndSpaces),e={__id:getParam(a[d],null,null,/договор[^\d]*(\d+)/i,replaceTagsAndSpaces),
__name:e,num:f};__shouldProcess("accounts",e)&&processAccount(a[d],e,c);b.accounts.push(e)}}else AnyBalance.trace(c),AnyBalance.trace("Не удалось найти аккаунты. Сайт изменён?")}}
function processAccount(c,b,a){AnyBalance.trace("Обработка счета "+b.__name);c=processParams(a,c,/<a[^>]+id="([\s\S]*?)"/i);c["javax.faces.source"]?(AnyBalance.requestPost(baseurl+"balanceOverviewPage.xhtml",c,addHeaders({Referer:baseurl+"balanceOverviewPage.xhtml","X-Requested-With":"XMLHttpRequest"})),a=AnyBalance.requestGet(baseurl+"cardAccountDetailsPage.xhtml",addHeaders({Referer:baseurl+"balanceOverviewPage.xhtml"})),getParam(a,b,"accounts.balance",/<span[^>]+balance-label[^>]*>([\s\S]*?)<\/div>/i,
replaceTagsAndSpaces,parseBalance),getParam(a,b,["accounts.currency","accounts.balance"],/<span[^>]+balance-label[^>]*>([\s\S]*?)<\/div>/i,replaceTagsAndSpaces,parseCurrency),getParam(a,b,"accounts.date_start",/договор(?:[^>]*>){2}[\s\S]*?(\d+\.\d+\.\d+)/i,replaceTagsAndSpaces,parseDate),getParam(a,b,"accounts.pct",/процентная ставка(?:[^>]*>){2}([^%]*)/i,replaceTagsAndSpaces,parseBalance),getParam(a,b,"accounts.cardnum",/<span[^>]+link-text[^>]*><span[^>]+link-text[^>]*>[\s\S]*?(\d{6}\*+\d{4})/i,
replaceTagsAndSpaces),isAvailable("accounts.transactions")&&processAccountTransactions(a,b)):(AnyBalance.trace(a),AnyBalance.trace("Не удалось найти параметры запроса по аккаунту "+b.__name))}
function processCards(c,b){if(AnyBalance.isAvailable("cards")){var a=getElement(c,/<div[^>]+mainForm:j_idt38_content[^>]*>/i),a=getElements(a,/<li[^>]+content-section[^>]*>/ig);if(a.length){AnyBalance.trace("Найдено карт:"+a.length);b.cards=[];for(var d=0;d<a.length;++d){var e=getParam(a[d],null,null,/<img[^>]*>[^\d]*(\d{6}\*+\d{4})/i),f=getParam(a[d],null,null,/<img[^>]*>[^\d]*(\d{6}\*+\d{4})/i),g=getParam(a[d],null,null,/<h1[^>]*>([\s\S]*?)<\/h1>/i,replaceTagsAndSpaces),e={__id:e,__name:g,num:f};
__shouldProcess("cards",e)&&processCard(a[d],e,c);b.cards.push(e)}}else AnyBalance.trace(c),AnyBalance.trace("Не удалось найти карты. Сайт изменён?")}}
function processCard(c,b,a){AnyBalance.trace("Обработка карты "+b.__name);c=processParams(a,c,/<td[^>]+info-panel[^>]*>[\s\S]*?<a[^>]+id="([^"]*)"/i);c["javax.faces.source"]?(AnyBalance.requestPost(baseurl+"balanceOverviewPage.xhtml",c,addHeaders({Referer:baseurl+"balanceOverviewPage.xhtml","X-Requested-With":"XMLHttpRequest"})),a=AnyBalance.requestGet(baseurl+"cardDetailsPage.xhtml",addHeaders({Referer:baseurl+"balanceOverviewPage.xhtml"})),getParam(a,b,"cards.balance",/<span[^>]+balance-label[^>]*>([\s\S]*?)<\/span>/i,
replaceTagsAndSpaces,parseBalance),getParam(a,b,["cards.currency","cards.balance"],/<span[^>]+balance-label[^>]*>([\s\S]*?)<\/div>/i,replaceTagsAndSpaces,parseCurrency),getParam(a,b,"cards.type",/тип карты(?:[^>]*>){3}([\s\S]*?)<\/td>/i,replaceTagsAndSpaces),getParam(a,b,"cards.date_start",/Срок действия(?:[^>]*>){6}([\s\S]*?)<\/span>/i,replaceTagsAndSpaces,parseDate),getParam(a,b,"cards.till",/Срок действия(?:[^>]*>){9}([\s\S]*?)<\/td>/i,replaceTagsAndSpaces,parseDate),getParam(a,b,"cards.acc",/Счет:(?:[^>]*>){5}([\s\S]*?)<\/td>/i,
replaceTagsAndSpaces),getParam(a,b,"cards.status",/<span[^>]+class=("[^"]*")*>Карта активна/i,[replaceTagsAndSpaces,/"ui-state-disabled"/i,"Неактивна",/""/i,"Активна"]),getParam(a,b,"cards.decure",/<span[^>]+class=("[^"]*")[^>]*>Услуга «3-D Secure»/i,[replaceTagsAndSpaces,/"ui-state-disabled"/i,"Неактивна",/""/i,"Активна"]),getParam(a,b,"cards.SMS",/<span[^>]+class=("[^"]*")[^>]*>Услуга «SMS-информирование»/i,[replaceTagsAndSpaces,/"ui-state-disabled"/i,"Неактивна",/""/i,"Активна"]),isAvailable("cards.transactions")&&
processCardTransactions(a,b)):(AnyBalance.trace(a),AnyBalance.trace("Не удалось найти параметры запроса по карте "+b.__name))}
function processDeposits(c,b){if(AnyBalance.isAvailable("deposits")){var a=getElement(c,/<div[^>]+mainForm:j_idt154_content[^>]*>/i),a=getElements(a,/<li[^>]+content-section[^>]*>/ig);if(a.length){AnyBalance.trace("Найдено депозитов: "+a.length);b.deposits=[];for(var d=0;d<a.length;++d){var e=getParam(a[d],null,null,/Договор[^\d]*(\d+)/i,replaceTagsAndSpaces),f=getParam(a[d],null,null,/Договор[^\d]*(\d+)/i,replaceTagsAndSpaces),g=getParam(a[d],null,null,/<h1[^>]*>([\s\S]*?)<\/h1>/i,replaceTagsAndSpaces),
e={__id:e,__name:g,num:f};__shouldProcess("deposits",e)&&processDeposit(a[d],e,c);b.deposits.push(e)}}else AnyBalance.trace(c),AnyBalance.trace("Не удалось найти депозиты.")}}
function processDeposit(c,b,a){AnyBalance.trace("Обработка депозита "+b.__name);c=processParams(a,c,/<li[^>]+datalist[^>]*>[\s\S]*?<a[^>]+id="([^"]*)"/i);c["javax.faces.source"]?(AnyBalance.requestPost(baseurl+"balanceOverviewPage.xhtml",c,addHeaders({Referer:baseurl+"balanceOverviewPage.xhtml","X-Requested-With":"XMLHttpRequest"})),a=AnyBalance.requestGet(baseurl+"depositDetailsPage.xhtml",addHeaders({Referer:baseurl+"balanceOverviewPage.xhtml"})),getParam(a,b,"deposits.balance",/<span[^>]+balance-label[^>]*>([\s\S]*?)<\/span>/i,
replaceTagsAndSpaces,parseBalance),getParam(a,b,"deposits.profit",/доходность(?:[^>]*>){2}([\s\S]*?)<\/td>/i,replaceTagsAndSpaces,parseBalance),getParam(a,b,["deposits.currency","deposits.balance","deposits.profit"],/доходность(?:[^>]*>){2}([\s\S]*?)<\/td>/i,replaceTagsAndSpaces,parseCurrency),getParam(a,b,"deposits.date_start",/договор[\s\S]*?от\s*(\d+\.\d+\.\d+)\s*<\/td>/i,replaceTagsAndSpaces,parseDate),getParam(a,b,"deposits.pct",/процентная ставка(?:[^>]*>){4}([^%]*)/i,replaceTagsAndSpaces,parseBalance),
getParam(a,b,"deposits.pctClose",/Ставка расторжения(?:[^>]*>){4}([^%]*)/i,replaceTagsAndSpaces,parseBalance),getParam(a,b,"deposits.duration",/Продолжительность(?:[^>]*>){2}([\s\S]*?)<\/td>/i,replaceTagsAndSpaces),getParam(a,b,"deposits.pct_condition",/Выплата процентов(?:[^>]*>){2}([\s\S]*?)<\/td>/i,replaceTagsAndSpaces),getParam(a,b,"deposits.capitalization",/Капитализация(?:[^>]*>){2}([\s\S]*?)<\/td>/i,replaceTagsAndSpaces),getParam(a,b,"deposits.withdraw",/Частичное снятие(?:[^>]*>){2}([\s\S]*?)<\/td>/i,
replaceTagsAndSpaces),getParam(a,b,"deposits.topup",/Пополнение(?:[^>]*>){2}([\s\S]*?)<\/td>/i,replaceTagsAndSpaces),getParam(a,b,"deposits.prolong",/Автопролонгация(?:[^>]*>){2}([\s\S]*?)<\/td>/i,replaceTagsAndSpaces),getParam(a,b,"deposits.revocation",/Отзыв депозита(?:[^>]*>){2}([\s\S]*?)<\/td>/i,replaceTagsAndSpaces),isAvailable("deposits.transactions")&&processDepositTransactions(a,b)):(AnyBalance.trace(a),AnyBalance.trace("Не удалось найти параметры запроса по депозиту "+b.__name))}
function processCredits(c,b){throw new AnyBalance.Error("Обработка кредитов пока не поддерживается. Пожалуйста, обратитесь к разработчикам.");}function processInfo(c,b){var a=b.info={};getParam(c,a,"info.fio",/<label[^>]+user-name[^>]*>([\s\S]*?)<\/label>/i,replaceTagsAndSpaces)}
function processParams(c,b,a){var d=getElement(c,/<form[^>]+mainform[^>]*>/i),d=createFormParams(d,function(a,b,c,d){return d});c=getParam(b?b:c,null,null,a);d["javax.faces.partial.ajax"]=!0;d["javax.faces.partial.execute"]="@all";d["javax.faces.source"]=c;d[c]=c;return d};
