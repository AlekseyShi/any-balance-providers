mask=bpe=0;radix=mask+1;digitsStr="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz_=!@#$%^&*()[]{}|;:,.<>/?`~ \\'\"+-";for(bpe=0;1<<bpe+1>1<<bpe;bpe++);bpe>>=1;mask=(1<<bpe)-1;radix=mask+1;one=int2bigInt(1,1,1);s_aa=s_x2=s_x1=s_d=s_b=s_n=s_r2=s_a=s_n1=s_q=s_rm=s_R=s_i2=s_i=pows=primes=md_tt=md_r2=md_r1=md_r=md_q3=md_q2=md_q1=eg_D=eg_C=eg_B=eg_A=eg_u=eg_v=mr_a=mr_r=mr_x1=sa=T=s7=s6=s5=s4=s3=s2=s1=s0=ss=t=[];
function findPrimes(a){var c,b,d;b=Array(a);for(c=0;c<a;c++)b[c]=0;b[0]=2;for(d=0;b[d]<a;){for(c=b[d]*b[d];c<a;c+=b[d])b[c]=1;d++;for(b[d]=b[d-1]+1;b[d]<a&&b[b[d]];b[d]++);}a=Array(d);for(c=0;c<d;c++)a[c]=b[c];return a}
function millerRabin(a,c){var b,d,e,f;mr_x1.length!=a.length&&(mr_x1=dup(a),mr_r=dup(a),mr_a=dup(a));copyInt_(mr_a,c);copy_(mr_r,a);copy_(mr_x1,a);addInt_(mr_r,-1);addInt_(mr_x1,-1);for(b=e=0;b<mr_r.length;b++)for(d=1;d<mask;d<<=1)a[b]&d?(f=e<mr_r.length+bpe?e:0,b=mr_r.length,d=mask):e++;f&&rightShift_(mr_r,f);powMod_(mr_a,mr_r,a);if(!equalsInt(mr_a,1)&&!equals(mr_a,mr_x1)){for(d=1;d<=f-1&&!equals(mr_a,mr_x1);){squareMod_(mr_a,a);if(equalsInt(mr_a,1))return 0;d++}if(!equals(mr_a,mr_x1))return 0}return 1}
function bitSize(a){var c,b;for(c=a.length-1;0==a[c]&&0<c;c--);b=0;for(a=a[c];a;a>>=1,b++);return b+=bpe*c}function expand(a,c){var b=int2bigInt(0,(a.length>c?a.length:c)*bpe,0);copy_(b,a);return b}function randTruePrime(a){var c=int2bigInt(0,a,0);randTruePrime_(c,a);return trim(c,1)}function mod(a,c){var b=dup(a);mod_(b,c);return trim(b,1)}function addInt(a,c){var b=expand(a,a.length+1);addInt_(b,c);return trim(b,1)}
function mult(a,c){var b=expand(a,a.length+c.length);mult_(b,c);return trim(b,1)}function powMod(a,c,b){a=expand(a,b.length);powMod_(a,trim(c,2),trim(b,2),0);return trim(a,1)}function sub(a,c){var b=expand(a,a.length>c.length?a.length+1:c.length+1);sub_(b,c);return trim(b,1)}function add(a,c){var b=expand(a,a.length>c.length?a.length+1:c.length+1);add_(b,c);return trim(b,1)}function inverseMod(a,c){var b=expand(a,c.length);return inverseMod_(b,c)?trim(b,1):null}
function multMod(a,c,b){a=expand(a,b.length);multMod_(a,c,b);return trim(a,1)}
function randTruePrime_(a,c){var b,d,e,f;0==primes.length&&(primes=findPrimes(3E4));if(0==pows.length)for(pows=Array(512),e=0;512>e;e++)pows[e]=Math.pow(2,e/511-1);recLimit=20;s_i2.length!=a.length&&(s_i2=dup(a),s_R=dup(a),s_n1=dup(a),s_r2=dup(a),s_d=dup(a),s_x1=dup(a),s_x2=dup(a),s_b=dup(a),s_n=dup(a),s_i=dup(a),s_rm=dup(a),s_q=dup(a),s_a=dup(a),s_aa=dup(a));if(c<=recLimit){b=(1<<(c+2>>1))-1;copyInt_(a,0);for(d=1;d;)for(d=0,a[0]=1|1<<c-1|Math.floor(Math.random()*(1<<c)),e=1;e<primes.length&&(primes[e]&
b)==primes[e];e++)if(0==a[0]%primes[e]){d=1;break}carry_(a)}else{b=.1*c*c;if(40<c)for(e=1;20>=c-c*e;)e=pows[Math.floor(512*Math.random())];else e=.5;e=Math.floor(e*c)+1;randTruePrime_(s_q,e);copyInt_(s_i2,0);s_i2[Math.floor((c-2)/bpe)]|=1<<(c-2)%bpe;divide_(s_i2,s_q,s_i,s_rm);for(d=bitSize(s_i);;){for(;randBigInt_(s_R,d,0),!greater(s_i,s_R););addInt_(s_R,1);add_(s_R,s_i);copy_(s_n,s_q);mult_(s_n,s_R);multInt_(s_n,2);addInt_(s_n,1);copy_(s_r2,s_R);multInt_(s_r2,2);for(e=f=0;e<primes.length&&primes[e]<
b;e++)if(0==modInt(s_n,primes[e])){f=1;break}f||millerRabin(s_n,2)||(f=1);if(!f){addInt_(s_n,-3);for(e=s_n.length-1;0==s_n[e]&&0<e;e--);f=0;for(w=s_n[e];w;w>>=1,f++);for(f+=bpe*e;randBigInt_(s_a,f,0),!greater(s_n,s_a););addInt_(s_n,3);addInt_(s_a,2);copy_(s_b,s_a);copy_(s_n1,s_n);addInt_(s_n1,-1);powMod_(s_b,s_n1,s_n);addInt_(s_b,-1);if(isZero(s_b)&&(copy_(s_b,s_a),powMod_(s_b,s_r2,s_n),addInt_(s_b,-1),copy_(s_aa,s_n),copy_(s_d,s_b),GCD_(s_d,s_n),equalsInt(s_d,1))){copy_(a,s_aa);break}}}}}
function randBigInt(a,c){var b;b=int2bigInt(0,0,Math.floor((a-1)/bpe)+2);randBigInt_(b,a,c);return b}function randBigInt_(a,c,b){var d,e;for(d=0;d<a.length;d++)a[d]=0;e=Math.floor((c-1)/bpe)+1;for(d=0;d<e;d++)a[d]=Math.floor(Math.random()*(1<<bpe-1));a[e-1]&=(2<<(c-1)%bpe)-1;1==b&&(a[e-1]|=1<<(c-1)%bpe)}function GCD(a,c){var b,d;b=dup(a);d=dup(c);GCD_(b,d);return b}
function GCD_(a,c){var b,d,e,f,g,h,m,l;T.length!=a.length&&(T=dup(a));for(l=1;l;){l=0;for(b=1;b<c.length;b++)if(c[b]){l=1;break}if(!l)break;for(b=a.length;!a[b]&&0<=b;b--);d=a[b];b=c[b];e=1;g=f=0;for(h=1;b+g&&b+h;){m=Math.floor((d+e)/(b+g));qp=Math.floor((d+f)/(b+h));if(m!=qp)break;t=e-m*g;e=g;g=t;t=f-m*h;f=h;h=t;t=d-m*b;d=b;b=t}f?(copy_(T,a),linComb_(a,c,e,f),linComb_(c,T,h,g)):(mod_(a,c),copy_(T,a),copy_(a,c),copy_(c,T))}if(0!=c[0])for(t=modInt(a,c[0]),copyInt_(a,c[0]),c[0]=t;c[0];)a[0]%=c[0],t=
a[0],a[0]=c[0],c[0]=t}
function inverseMod_(a,c){var b=1+2*Math.max(a.length,c.length);if(!(a[0]&1||c[0]&1))return copyInt_(a,0),0;eg_u.length!=b&&(eg_u=Array(b),eg_v=Array(b),eg_A=Array(b),eg_B=Array(b),eg_C=Array(b),eg_D=Array(b));copy_(eg_u,a);copy_(eg_v,c);copyInt_(eg_A,1);copyInt_(eg_B,0);copyInt_(eg_C,0);for(copyInt_(eg_D,1);;){for(;!(eg_u[0]&1);)halve_(eg_u),eg_A[0]&1||eg_B[0]&1?(add_(eg_A,c),halve_(eg_A),sub_(eg_B,a)):halve_(eg_A),halve_(eg_B);for(;!(eg_v[0]&1);)halve_(eg_v),eg_C[0]&1||eg_D[0]&1?(add_(eg_C,c),halve_(eg_C),
sub_(eg_D,a)):halve_(eg_C),halve_(eg_D);greater(eg_v,eg_u)?(sub_(eg_v,eg_u),sub_(eg_C,eg_A),sub_(eg_D,eg_B)):(sub_(eg_u,eg_v),sub_(eg_A,eg_C),sub_(eg_B,eg_D));if(equalsInt(eg_u,0))return negative(eg_C)&&add_(eg_C,c),copy_(a,eg_C),equalsInt(eg_v,1)?1:(copyInt_(a,0),0)}}function inverseModInt(a,c){for(var b=1,d=0;;){if(1==a)return b;if(0==a)return 0;d-=b*Math.floor(c/a);c%=a;if(1==c)return d;if(0==c)return 0;b-=d*Math.floor(a/c);a%=c}}function inverseModInt_(a,c){return inverseModInt(a,c)}
function eGCD_(a,c,b,d,e){var f=0,g=Math.max(a.length,c.length);eg_u.length!=g&&(eg_u=Array(g),eg_A=Array(g),eg_B=Array(g),eg_C=Array(g),eg_D=Array(g));for(;!(a[0]&1||c[0]&1);)halve_(a),halve_(c),f++;copy_(eg_u,a);copy_(b,c);copyInt_(eg_A,1);copyInt_(eg_B,0);copyInt_(eg_C,0);for(copyInt_(eg_D,1);;){for(;!(eg_u[0]&1);)halve_(eg_u),eg_A[0]&1||eg_B[0]&1?(add_(eg_A,c),halve_(eg_A),sub_(eg_B,a)):halve_(eg_A),halve_(eg_B);for(;!(b[0]&1);)halve_(b),eg_C[0]&1||eg_D[0]&1?(add_(eg_C,c),halve_(eg_C),sub_(eg_D,
a)):halve_(eg_C),halve_(eg_D);greater(b,eg_u)?(sub_(b,eg_u),sub_(eg_C,eg_A),sub_(eg_D,eg_B)):(sub_(eg_u,b),sub_(eg_A,eg_C),sub_(eg_B,eg_D));if(equalsInt(eg_u,0)){negative(eg_C)&&(add_(eg_C,c),sub_(eg_D,a));multInt_(eg_D,-1);copy_(d,eg_C);copy_(e,eg_D);leftShift_(b,f);break}}}function negative(a){return a[a.length-1]>>bpe-1&1}
function greaterShift(a,c,b){var d=a.length,e=c.length;k=d+b<e?d+b:e;for(i=e-1-b;i<d&&0<=i;i++)if(0<a[i])return 1;for(i=d-1+b;i<e;i++)if(0<c[i])return 0;for(i=k-1;i>=b;i--){if(a[i-b]>c[i])return 1;if(a[i-b]<c[i])break}return 0}function greater(a,c){var b,d=a.length<c.length?a.length:c.length;for(b=a.length;b<c.length;b++)if(c[b])return 0;for(b=c.length;b<a.length;b++)if(a[b])return 1;for(b=d-1;0<=b;b--){if(a[b]>c[b])return 1;if(a[b]<c[b])break}return 0}
function divide_(a,c,b,d){var e,f,g,h,m;copy_(d,a);for(a=c.length;0==c[a-1];a--);e=c[a-1];for(m=0;e;m++)e>>=1;m=bpe-m;leftShift_(c,m);leftShift_(d,m);for(e=d.length;0==d[e-1]&&e>a;e--);for(copyInt_(b,0);!greaterShift(c,d,e-a);)subShift_(d,c,e-a),b[e-a]++;for(--e;e>=a;e--){for(b[e-a]=d[e]==c[a-1]?mask:Math.floor((d[e]*radix+d[e-1])/c[a-1]);;)if(g=(1<a?c[a-2]:0)*b[e-a],h=g>>bpe,g&=mask,f=h+b[e-a]*c[a-1],h=f>>bpe,f&=mask,h==d[e]?f==d[e-1]?g>(1<e?d[e-2]:0):f>d[e-1]:h>d[e])b[e-a]--;else break;linCombShift_(d,
c,-b[e-a],e-a);negative(d)&&(addShift_(d,c,e-a),b[e-a]--)}rightShift_(c,m);rightShift_(d,m)}function carry_(a){var c,b,d,e;b=a.length;for(c=d=0;c<b;c++)d+=a[c],e=0,0>d&&(e=-(d>>bpe),d+=e*radix),a[c]=d&mask,d=(d>>bpe)-e}function modInt(a,c){var b,d=0;for(b=a.length-1;0<=b;b--)d=(d*radix+a[b])%c;return d}function int2bigInt(a,c,b){c=Math.ceil(c/bpe)+1;buff=Array(b>c?b:c);copyInt_(buff,a);return buff}
function str2bigInt(a,c,b){var d,e,f,g=a.length;if(-1==c){for(f=[];;){c=Array(f.length+1);for(e=0;e<f.length;e++)c[e+1]=f[e];c[0]=parseInt(a,10);f=c;d=a.indexOf(",",0);if(1>d)break;a=a.substring(d+1);if(0==a.length)break}return f.length<b?(c=Array(b),copy_(c,f),c):f}f=int2bigInt(0,c*g,0);for(e=0;e<g;e++)d=digitsStr.indexOf(a.substring(e,e+1),0),36>=c&&36<=d&&(d-=26),d<c&&0<=d&&(multInt_(f,c),addInt_(f,d));for(g=f.length;0<g&&!f[g-1];g--);g=b>g+1?b:g+1;c=Array(g);a=g<f.length?g:f.length;for(e=0;e<
a;e++)c[e]=f[e];for(;e<g;e++)c[e]=0;return c}function equalsInt(a,c){var b;if(a[0]!=c)return 0;for(b=1;b<a.length;b++)if(a[b])return 0;return 1}function equals(a,c){var b,d=a.length<c.length?a.length:c.length;for(b=0;b<d;b++)if(a[b]!=c[b])return 0;if(a.length>c.length)for(;b<a.length;b++){if(a[b])return 0}else for(;b<c.length;b++)if(c[b])return 0;return 1}function isZero(a){var c;for(c=0;c<a.length;c++)if(a[c])return 0;return 1}
function bigInt2str(a,c){var b,d="";s6.length!=a.length?s6=dup(a):copy_(s6,a);if(-1==c){for(b=a.length-1;0<b;b--)d+=a[b]+",";d+=a[0]}else for(;!isZero(s6);)b=divInt_(s6,c),d=digitsStr.substring(b,b+1)+d;1==d.length%2&&(d="0"+d);return d}function dup(a){buff=Array(a.length);copy_(buff,a);return buff}function copy_(a,c){var b,d=a.length<c.length?a.length:c.length;for(b=0;b<d;b++)a[b]=c[b];for(b=d;b<a.length;b++)a[b]=0}function copyInt_(a,c){var b,d;d=c;for(b=0;b<a.length;b++)a[b]=d&mask,d>>=bpe}
function addInt_(a,c){var b,d,e,f;a[0]+=c;d=a.length;for(b=e=0;b<d&&(e+=a[b],f=0,0>e&&(f=-(e>>bpe),e+=f*radix),a[b]=e&mask,e=(e>>bpe)-f,e);b++);}function rightShift_(a,c){var b,d=Math.floor(c/bpe);if(d){for(b=0;b<a.length-d;b++)a[b]=a[b+d];for(;b<a.length;b++)a[b]=0;c%=bpe}for(b=0;b<a.length-1;b++)a[b]=mask&(a[b+1]<<bpe-c|a[b]>>c);a[b]>>=c}function halve_(a){var c;for(c=0;c<a.length-1;c++)a[c]=mask&(a[c+1]<<bpe-1|a[c]>>1);a[c]=a[c]>>1|a[c]&radix>>1}
function leftShift_(a,c){var b,d=Math.floor(c/bpe);if(d){for(b=a.length;b>=d;b--)a[b]=a[b-d];for(;0<=b;b--)a[b]=0;c%=bpe}if(c){for(b=a.length-1;0<b;b--)a[b]=mask&(a[b]<<c|a[b-1]>>bpe-c);a[b]=mask&a[b]<<c}}function multInt_(a,c){var b,d,e,f;if(c)for(d=a.length,b=e=0;b<d;b++)e+=a[b]*c,f=0,0>e&&(f=-(e>>bpe),e+=f*radix),a[b]=e&mask,e=(e>>bpe)-f}function divInt_(a,c){var b,d=0;for(b=a.length-1;0<=b;b--)d=d*radix+a[b],a[b]=Math.floor(d/c),d%=c;return d}
function linComb_(a,c,b,d){var e,f,g,h;g=a.length<c.length?a.length:c.length;h=a.length;for(e=f=0;e<g;e++)f+=b*a[e]+d*c[e],a[e]=f&mask,f>>=bpe;for(e=g;e<h;e++)f+=b*a[e],a[e]=f&mask,f>>=bpe}function linCombShift_(a,c,b,d){var e,f,g,h;g=a.length<d+c.length?a.length:d+c.length;h=a.length;f=0;for(e=d;e<g;e++)f+=a[e]+b*c[e-d],a[e]=f&mask,f>>=bpe;for(e=g;f&&e<h;e++)f+=a[e],a[e]=f&mask,f>>=bpe}
function addShift_(a,c,b){var d,e,f,g;f=a.length<b+c.length?a.length:b+c.length;g=a.length;e=0;for(d=b;d<f;d++)e+=a[d]+c[d-b],a[d]=e&mask,e>>=bpe;for(d=f;e&&d<g;d++)e+=a[d],a[d]=e&mask,e>>=bpe}function subShift_(a,c,b){var d,e,f,g;f=a.length<b+c.length?a.length:b+c.length;g=a.length;e=0;for(d=b;d<f;d++)e+=a[d]-c[d-b],a[d]=e&mask,e>>=bpe;for(d=f;e&&d<g;d++)e+=a[d],a[d]=e&mask,e>>=bpe}
function sub_(a,c){var b,d,e;e=a.length<c.length?a.length:c.length;for(b=d=0;b<e;b++)d+=a[b]-c[b],a[b]=d&mask,d>>=bpe;for(b=e;d&&b<a.length;b++)d+=a[b],a[b]=d&mask,d>>=bpe}function add_(a,c){var b,d,e;e=a.length<c.length?a.length:c.length;for(b=d=0;b<e;b++)d+=a[b]+c[b],a[b]=d&mask,d>>=bpe;for(b=e;d&&b<a.length;b++)d+=a[b],a[b]=d&mask,d>>=bpe}function mult_(a,c){var b;ss.length!=2*a.length&&(ss=Array(2*a.length));copyInt_(ss,0);for(b=0;b<c.length;b++)c[b]&&linCombShift_(ss,a,c[b],b);copy_(a,ss)}
function mod_(a,c){s4.length!=a.length?s4=dup(a):copy_(s4,a);s5.length!=a.length&&(s5=dup(a));divide_(s4,c,s5,a)}function multMod_(a,c,b){var d;s0.length!=2*a.length&&(s0=Array(2*a.length));copyInt_(s0,0);for(d=0;d<c.length;d++)c[d]&&linCombShift_(s0,a,c[d],d);mod_(s0,b);copy_(a,s0)}
function squareMod_(a,c){var b,d,e,f;for(f=a.length;0<f&&!a[f-1];f--);b=f>c.length?2*f:2*c.length;s0.length!=b&&(s0=Array(b));copyInt_(s0,0);for(b=0;b<f;b++){e=s0[2*b]+a[b]*a[b];s0[2*b]=e&mask;e>>=bpe;for(d=b+1;d<f;d++)e=s0[b+d]+2*a[b]*a[d]+e,s0[b+d]=e&mask,e>>=bpe;s0[b+f]=e}mod_(s0,c);copy_(a,s0)}function trim(a,c){var b;for(b=a.length;0<b&&!a[b-1];b--);b=Array(b+c);copy_(b,a);return b}
function powMod_(a,c,b){var d,e,f;s7.length!=b.length&&(s7=dup(b));if(0==(b[0]&1))for(copy_(s7,a),copyInt_(a,1);!equalsInt(c,0);)c[0]&1&&multMod_(a,s7,b),divInt_(c,2),squareMod_(s7,b);else{copyInt_(s7,0);for(d=b.length;0<d&&!b[d-1];d--);f=radix-inverseModInt(modInt(b,radix),radix);s7[d]=1;multMod_(a,s7,b);s3.length!=a.length?s3=dup(a):copy_(s3,a);for(d=c.length-1;0<d&!c[d];d--);if(0==c[d])copyInt_(a,1);else{for(e=1<<bpe-1;e&&!(c[d]&e);e>>=1);for(;;){if(!(e>>=1)){d--;if(0>d){mont_(a,one,b,f);break}e=
1<<bpe-1}mont_(a,a,b,f);e&c[d]&&mont_(a,s3,b,f)}}}}function mont_(a,c,b,d){var e,f,g,h,m,l=b.length,p=c.length;for(sa.length!=l&&(sa=Array(l));0<l&&0==b[l-1];l--);copyInt_(sa,0);for(e=0;e<l;e++){m=sa[0]+a[e]*c[0];h=(m&mask)*d&mask;g=m+h*b[0]>>bpe;m=a[e];for(f=1;f<p;f++)g+=sa[f]+m*c[f]+h*b[f],sa[f-1]=g&mask,g>>=bpe;for(;f<l;f++)g+=sa[f]+h*b[f],sa[f-1]=g&mask,g>>=bpe;sa[f-1]=g&mask}greater(b,sa)||sub_(sa,b);copy_(a,sa)};/*
 http://www.gnu.org/licenses/gpl.html [GNU General Public License]
 @param {jQuery} {sha1:function(string))
 @return string
*/
function SHA256(a){function c(a,b){var c=(a&65535)+(b&65535);return(a>>16)+(b>>16)+(c>>16)<<16|c&65535}function b(a,b){return a>>>b|a<<32-b}a=function(a){a=a.replace(/\r\n/g,"\n");for(var b="",c=0;c<a.length;c++){var g=a.charCodeAt(c);128>g?b+=String.fromCharCode(g):(127<g&&2048>g?b+=String.fromCharCode(g>>6|192):(b+=String.fromCharCode(g>>12|224),b+=String.fromCharCode(g>>6&63|128)),b+=String.fromCharCode(g&63|128))}return b}(a);return function(a){for(var b="",c=0;c<4*a.length;c++)b+="0123456789abcdef".charAt(a[c>>
2]>>8*(3-c%4)+4&15)+"0123456789abcdef".charAt(a[c>>2]>>8*(3-c%4)&15);return b}(function(a,e){var f=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,
2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],g=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],h=Array(64),m,l,p,q,r,n,u,y,B,v,x,z;a[e>>5]|=128<<24-e%32;a[(e+64>>9<<4)+15]=e;for(B=0;B<a.length;B+=16){m=g[0];l=g[1];p=g[2];q=g[3];
r=g[4];n=g[5];u=g[6];y=g[7];for(v=0;64>v;v++){if(16>v)h[v]=a[v+B];else{x=v;z=h[v-2];z=b(z,17)^b(z,19)^z>>>10;z=c(z,h[v-7]);var A;A=h[v-15];A=b(A,7)^b(A,18)^A>>>3;h[x]=c(c(z,A),h[v-16])}x=r;x=b(x,6)^b(x,11)^b(x,25);x=c(c(c(c(y,x),r&n^~r&u),f[v]),h[v]);y=m;y=b(y,2)^b(y,13)^b(y,22);z=c(y,m&l^m&p^l&p);y=u;u=n;n=r;r=c(q,x);q=p;p=l;l=m;m=c(x,z)}g[0]=c(m,g[0]);g[1]=c(l,g[1]);g[2]=c(p,g[2]);g[3]=c(q,g[3]);g[4]=c(r,g[4]);g[5]=c(n,g[5]);g[6]=c(u,g[6]);g[7]=c(y,g[7])}return g}(function(a){for(var b=[],c=0;c<
8*a.length;c+=8)b[c>>5]|=(a.charCodeAt(c/8)&255)<<24-c%32;return b}(a),8*a.length))}var hex_chr="0123456789abcdef";function hex(a){for(var c="",b=7;0<=b;b--)c+=hex_chr.charAt(a>>4*b&15);return c}function str2blks_SHA1(a){for(var c=(a.length+8>>6)+1,b=Array(16*c),d=0;d<16*c;d++)b[d]=0;for(d=0;d<a.length;d++)b[d>>2]|=a.charCodeAt(d)<<24-d%4*8;b[d>>2]|=128<<24-d%4*8;b[16*c-1]=8*a.length;return b}
function hex2blks_SHA1(a){for(var c=a.length+1>>1,b=(c+8>>6)+1,d=Array(16*b),e=0;e<16*b;e++)d[e]=0;for(e=0;e<c;e++)d[e>>2]|=parseInt(a.substr(2*e,2),16)<<24-e%4*8;d[e>>2]|=128<<24-e%4*8;d[16*b-1]=8*c;return d}function ba2blks_SHA1(a,c,b){for(var d=(b+8>>6)+1,e=Array(16*d),f=0;f<16*d;f++)e[f]=0;for(f=0;f<b;f++)e[f>>2]|=(a[c+f]&255)<<24-f%4*8;e[f>>2]|=128<<24-f%4*8;e[16*d-1]=8*b;return e}function sha1_add(a,c){var b=(a&65535)+(c&65535);return(a>>16)+(c>>16)+(b>>16)<<16|b&65535}
function rol(a,c){return a<<c|a>>>32-c}function ft(a,c,b,d){return 20>a?c&b|~c&d:40>a?c^b^d:60>a?c&b|c&d|b&d:c^b^d}function kt(a){return 20>a?1518500249:40>a?1859775393:60>a?-1894007588:-899497514}function bad_calcSHA1(a){return calcSHA1Blks(str2blks_SHA1(a))}function calcSHA1Hex(a){return calcSHA1Blks(hex2blks_SHA1(a))}function calcSHA1BA(a){return calcSHA1Blks(ba2blks_SHA1(a,0,a.length))}function calcSHA1BAEx(a,c,b){return calcSHA1Blks(ba2blks_SHA1(a,c,b))}
function calcSHA1Blks(a){a=calcSHA1Raw(a);return hex(a[0])+hex(a[1])+hex(a[2])+hex(a[3])+hex(a[4])}
function calcSHA1Raw(a){for(var c=Array(80),b=1732584193,d=-271733879,e=-1732584194,f=271733878,g=-1009589776,h=0;h<a.length;h+=16){for(var m=b,l=d,p=e,q=f,r=g,n=0;80>n;n++){var u;c[n]=16>n?a[h+n]:rol(c[n-3]^c[n-8]^c[n-14]^c[n-16],1);u=sha1_add(sha1_add(rol(b,5),ft(n,d,e,f)),sha1_add(sha1_add(g,c[n]),kt(n)));g=f;f=e;e=rol(d,30);d=b;b=u}b=sha1_add(b,m);d=sha1_add(d,l);e=sha1_add(e,p);f=sha1_add(f,q);g=sha1_add(g,r)}return[b,d,e,f,g]}
function core_sha1(a,c){a[c>>5]|=128<<24-c%32;a[(c+64>>9<<4)+15]=c;return calcSHA1Raw(a)}
var rotateLeft=function(a,c){return a<<c|a>>>32-c},lsbHex=function(a){var c="",b,d,e;for(b=0;6>=b;b+=2)d=a>>>4*b+4&15,e=a>>>4*b&15,c+=d.toString(16)+e.toString(16);return c},cvtHex=function(a){var c="",b,d;for(b=7;0<=b;b--)d=a>>>4*b&15,c+=d.toString(16);return c},uTF8Encode=function(a){a=a.replace(/\x0d\x0a/g,"\n");for(var c="",b=0;b<a.length;b++){var d=a.charCodeAt(b);128>d?c+=String.fromCharCode(d):(127<d&&2048>d?c+=String.fromCharCode(d>>6|192):(c+=String.fromCharCode(d>>12|224),c+=String.fromCharCode(d>>
6&63|128)),c+=String.fromCharCode(d&63|128))}return c};
function calcSHA1(a){var c,b,d=Array(80),e=1732584193,f=4023233417,g=2562383102,h=271733878,m=3285377520,l,p,q,r,n;a=uTF8Encode(a);l=a.length;var u=[];for(c=0;c<l-3;c+=4)b=a.charCodeAt(c)<<24|a.charCodeAt(c+1)<<16|a.charCodeAt(c+2)<<8|a.charCodeAt(c+3),u.push(b);switch(l%4){case 0:c=2147483648;break;case 1:c=a.charCodeAt(l-1)<<24|8388608;break;case 2:c=a.charCodeAt(l-2)<<24|a.charCodeAt(l-1)<<16|32768;break;case 3:c=a.charCodeAt(l-3)<<24|a.charCodeAt(l-2)<<16|a.charCodeAt(l-1)<<8|128}for(u.push(c);14!=
u.length%16;)u.push(0);u.push(l>>>29);u.push(l<<3&4294967295);for(a=0;a<u.length;a+=16){for(c=0;16>c;c++)d[c]=u[a+c];for(c=16;79>=c;c++)d[c]=rotateLeft(d[c-3]^d[c-8]^d[c-14]^d[c-16],1);b=e;l=f;p=g;q=h;r=m;for(c=0;19>=c;c++)n=rotateLeft(b,5)+(l&p|~l&q)+r+d[c]+1518500249&4294967295,r=q,q=p,p=rotateLeft(l,30),l=b,b=n;for(c=20;39>=c;c++)n=rotateLeft(b,5)+(l^p^q)+r+d[c]+1859775393&4294967295,r=q,q=p,p=rotateLeft(l,30),l=b,b=n;for(c=40;59>=c;c++)n=rotateLeft(b,5)+(l&p|l&q|p&q)+r+d[c]+2400959708&4294967295,
r=q,q=p,p=rotateLeft(l,30),l=b,b=n;for(c=60;79>=c;c++)n=rotateLeft(b,5)+(l^p^q)+r+d[c]+3395469782&4294967295,r=q,q=p,p=rotateLeft(l,30),l=b,b=n;e=e+b&4294967295;f=f+l&4294967295;g=g+p&4294967295;h=h+q&4294967295;m=m+r&4294967295}n=cvtHex(e)+cvtHex(f)+cvtHex(g)+cvtHex(h)+cvtHex(m);return n.toLowerCase()}
function btoa(a){for(var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),b=0,d=0,e=a.length/3,f=[];b<e;++b){var g=a.charCodeAt(d++),h=a.charCodeAt(d++),m=a.charCodeAt(d++);if(255<(g|h|m))throw Error("String contains an invalid character");f[f.length]=c[g>>2]+c[g<<4&63|h>>4]+(isNaN(h)?"=":c[h<<2&63|m>>6])+(isNaN(h+m)?"=":c[m&63])}return f.join("")}
function hexToBase64(a){return btoa(String.fromCharCode.apply(null,a.replace(/\r|\n/g,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")))};var pN=str2bigInt("115b8b692e0e045692cf280b436735c77a5a9e8a9e7ed56c965f87db5b2a2ece3",16,0),pNBitsLen=264,pg=str2bigInt("02",16,0),pk=str2bigInt("dbe5dfe0704fee4c85ff106ecd38117d33bcfe50",16,0),pabBitsLen=256;function SRPClientContext(a,c){this.vS=a;this.vBbs=c;this.va=randBigInt(pabBitsLen,1);this.vA=powMod(pg,this.va,pN)}
SRPClientContext.prototype.makeAuthorizationData=function(a,c){var b=calcSHA1(a+":"+(null==c?"":c)),d=str2bigInt(this.vBbs,16,1),b=this.xCalculate(b,this.vS),e=srp_compute_u(this.getAbytes(),this.vBbs);if(isZero(mod(d,pN))||isZero(e))throw"Bad SRP server data";var f=powMod(pg,b,pN),f=mult(f,pk),d=add(d,mult(pN,pk)),d=sub(d,f),d=mod(d,pN),b=add(this.va,mult(b,e)),d=powMod(d,b,pN);return calcSHA1Hex(bigInt2str(d,16))};SRPClientContext.prototype.getAbytes=function(){return bigInt2str(this.vA,16)};
SRPClientContext.prototype.xCalculate=function(a,c){var b=calcSHA1Hex(c+a),b=str2bigInt(b,16);greater(b,pN)&&(b=mod(b,pN));return b};function srp_compute_u(a,c){var b,d=2*(pNBitsLen>>3);b=""+(srp_nzero(d-a.length)+a);b+=srp_nzero(d-c.length)+c;b=calcSHA1Hex(b);b=str2bigInt(b,16,0);greater(b,pN)&&(b=mod(b,pN));return b}function srp_nzero(a){if(1>a)return"";var c=srp_nzero(a>>1);return 0==(a&1)?c+c:c+c+"0"};var g_headers={Accept:"*/*","User-Agent":"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.75 Safari/537.36","Accept-Language":"ru,en;q=0.8",Origin:"https://online.skbbank.ru","Content-type":"application/x-www-form-urlencoded; charset=UTF-8"},baseurl="https://online.skbbank.ru/",errors={BAD_CREDENTIALS:"Неправльное имя пользователя или пароль"};
function login(){function a(a){if(!/OK/i.test(a)){var b=errors[getParam(a,null,null,null,AB.replaceTagsAndSpaces)];if(b)throw new AnyBalance.Error(b,null,/Неправльное имя пользователя или пароль/i.test(b));AnyBalance.trace(a);throw new AnyBalance.Error("Не удалось зайти в интернет-банк. Сайт изменен?");}}var c=AnyBalance.getPreferences();AnyBalance.setDefaultCharset("utf-8");checkEmpty(c.login,"Введите логин!");checkEmpty(c.password,"Введите пароль!");AnyBalance.setOptions({SSL_ENABLED_PROTOCOLS:["TLSv1.2"]});
c.login=c.login.toLowerCase();var b=AnyBalance.requestGet(baseurl+"auto/html/index.html",g_headers);if(!b||400<AnyBalance.getLastStatusCode())throw AnyBalance.trace(b),new AnyBalance.Error("Ошибка при подключении к сайту интернет-банка! Попробуйте обновить данные позже.");if(/Подождите, идет загрузка.../i.test(b))AnyBalance.trace("Уже залогинены, используем существующую сессию");else{b=AnyBalance.requestPost(baseurl+"service/prelogin",{userName:c.login},addHeaders({Referer:baseurl+"ru/html/login.html"}));
AnyBalance.trace("BSS response: "+b);var d=b.split(";"),e=d[2],f=d[3],b=d[4],g=new SRPClientContext(d[0],d[1]),d=g.makeAuthorizationData(e,c.password),h=calcSHA1(c.password),m=g.makeAuthorizationData(e,h),e=g.makeAuthorizationData(e,calcSHA1(hexToBase64(h)+f)),f=g.getAbytes(),b=AnyBalance.requestPost(baseurl+"service/login",{userName:c.login,passwordData:d,passwordDataSHA:m,passwordDataSHASalt:e,extPasswordData:f,language:"ru",preloginId:b},addHeaders({Referer:baseurl+"ru/html/login.html"}));a(b);
b=AnyBalance.requestPost(baseurl+"ru/auth.rt",{userName:c.login,signId:""},addHeaders({Accept:"application/json, text/javascript, */*; q=0.01",Referer:baseurl+"ru/html/login.html","X-Requested-With":"XMLHttpRequest"}));a(b);b=AnyBalance.requestGet(baseurl+"service/postLogin",AB.addHeaders({"X-Requested-With":"XMLHttpRequest",Referer:baseurl+"ru/html/login.html"}));a(b);b=AnyBalance.requestGet(baseurl+"def/retail/login.rt",AB.addHeaders({Referer:baseurl+"ru/html/login.html"}))}if(!/BSSCore\.logout\(\)/i.test(b)){if(c=
errors[getParam(b,null,null,null,replaceTagsAndSpaces)])throw new AnyBalance.Error(c,null,/Неправльное имя пользователя или пароль/i.test(c));AnyBalance.trace(b);throw new AnyBalance.Error("Не удалось зайти в интернет-банк. Сайт изменен?");}__setLoginSuccessful();return b}function getInfoJson(a,c){var b=AnyBalance.requestPost(baseurl+a,{JSID:c},addHeaders({Referer:baseurl+"auto/html/index.html","X-Requested-With":"XMLHttpRequest"}));try{var d=getJson(b)}catch(e){d={data:{}}}return d}
function processAccounts(a,c){if(AnyBalance.isAvailable("accounts")){var b=getParam(a,null,null,/var\s+JSID\s*=\s*'([^']+)/i);if(isset(b)){b=getInfoJson("ru/retail/accounts.rt",b).data[0].accounts;AnyBalance.trace("Найдено счетов: "+b.length);c.accounts=[];for(var d=0;d<b.length;++d){var e=b[d],f=e.benefacc,e={__id:f,__name:e.acctype+" "+f+" "+e.curr,num:e.acc};__shouldProcess("accounts",e);c.accounts.push(e)}}}}
function processAccount(a,c){AnyBalance.trace("Обработка счета "+c.__name);getParam(a.acctype,c,"accounts.type");getParam(a.balance,c,"accounts.balance",null,null,parseBalanceSilent);getParam(a.currency,c,["accounts.currency","accounts.balance"],null,null,parseCurrency);getParam(a.date,c,"accounts.date_start",null,null,parseDateWord);AnyBalance.isAvailable("accounts.transactions")&&processAccountTransactions(html,c)}
function processCards(a,c){if(AnyBalance.isAvailable("cards")){var b=getParam(a,null,null,/var\s+JSID\s*=\s*'([^']+)/i);if(isset(b))if(b=getInfoJson("ru/retail/cards?r=version:%202.2.0.167.SKBrevision:%204697c8e2d4d862a3289a93bdb56d5741d290a3c5",b),b.data[0].cardsList){b=b.data[0].cardsList;AnyBalance.trace("Найдено карт: "+b.length);c.cards=[];for(var d=0;d<b.length;++d){var e=b[d],f=e.number,f={__id:e.id,__name:f+" "+e.name,num:f};__shouldProcess("cards",f)&&processCard(e,f);c.cards.push(f)}}else/У вас нет карт/i.test(a)?
(AnyBalance.trace("У вас нет карт"),c.cards=[]):(AnyBalance.trace(JSON.stringify(b)),AnyBalance.trace("Не удалось найти таблицу с картами."))}}
function processCard(a,c){AnyBalance.trace("Обработка карты "+c.__name);getParam(a.amount,c,"cards.amount",null,replaceTagsAndSpaces,parseBalanceSilent);getParam(a.balance,c,"cards.balance",null,replaceTagsAndSpaces,parseBalanceSilent);getParam(a.creditLimit,c,"cards.limit",null,replaceTagsAndSpaces,parseBalanceSilent);getParam(a.currCode,c,["cards.currency","cards.balance","cards.amount","cards.limit"],null,replaceTagsAndSpaces);getParam(a.validDate+"",c,"cards.till",null,replaceTagsAndSpaces,parseDateWord);
getParam(a.holderName,c,"cards.holderName",null,replaceTagsAndSpaces);getParam(a.cardAccount,c,"cards.acc_num");getParam(a.name,c,"cards.name");getParam(a.cardSort,c,"cards.type",null,replaceTagsAndSpaces);isAvailable("cards.transactions")&&processCardTransactions(a,c)}
function processDeposits(a,c){if(AnyBalance.isAvailable("deposits")){var b=getParam(a,null,null,/var\s+JSID\s*=\s*'([^']+)/i);if(isset(b)){b=getInfoJson("ru/retail/deposits?r=version:%202.2.0.167.SKBrevision:%204697c8e2d4d862a3289a93bdb56d5741d290a3c5",b).data[0].accounts;AnyBalance.trace("Найдено депозитов: "+b.length);c.deposits=[];for(var d=0;d<b.length;++d){var e=b[d],f={__id:e.id,__name:e.name,num:e.account};__shouldProcess("deposits",f)&&processDeposit(e,f);c.deposits.push(f)}}}}
function processDeposit(a,c){AnyBalance.trace("Обработка депозита "+c.__name);getParam(a.amount,c,"deposits.balance",null,replaceTagsAndSpaces,parseBalanceSilent);getParam(a.currIso,c,["deposits.currency","deposits.balance"]);getParam(a.dateClose,c,"deposits.till",null,replaceTagsAndSpaces,parseDateSilent);getParam(a.interestRate,c,"deposits.pct",null,replaceTagsAndSpaces,parseBalanceSilent);isAvailable("deposits.transactions")&&processDepositTransactions(a,c)}
function processInfo(a,c){function b(a){a=AnyBalance.requestPost(baseurl+"ru/retail/personalData/fillBlock.rt",{JSID:d,blockNumber:a},addHeaders({Referer:baseurl+"auto/html/index.html","X-Requested-With":"XMLHttpRequest"}));try{var b=getJson(a)}catch(c){b={data:{}}}return b}var d=getParam(a,null,null,/var\s+JSID\s*=\s*'([^']+)/i);if(isset(d)){var e=c.info={},f=b("1");getParam(f.data.nameFull,e,"info.fio");f=b("2");getParam(f.data.birthDate,e,"info.birthday",null,replaceTagsAndSpaces,parseDate);getParam(f.data.birthPlace,
e,"info.birthPlace",null,replaceTagsAndSpaces);getParam(f.data.citizenship,e,"info.citizenship",null,replaceTagsAndSpaces);f=b("3");getParam(f.data.passportSeries,e,"info.passportSeries",null,replaceTagsAndSpaces);getParam(f.data.passportNumber,e,"info.passport",null,replaceTagsAndSpaces);getParam(f.data.passportDate,e,"info.passportDate",null,replaceTagsAndSpaces,parseDate);getParam(f.data.passportPlace,e,"info.passportPlace",null,replaceTagsAndSpaces);f=b("5");getParam(f.data.mobilePhone,e,"info.mphone",
null,replaceTagsAndSpaces);getParam(f.data.workPhone,e,"info.wphone",null,replaceTagsAndSpaces);getParam(f.data.email,e,"info.email",null,replaceTagsAndSpaces)}};
