function Email(){var q=new Date,l=AnyBalance.requestGet("https://10minutemail.net/",addHeaders({})),g=getParam(l,null,null,/<input[^>]+id="fe_text"[^>]*value="([^"]*)/i);if(!g)throw AnyBalance.trace(l),new AnyBalance.Error("Не удалось получить временный e-mail!");var m;return{email:g,waitForEmails:function(n,r){var p={},g=(new Date).getTime();do{var a;a=AnyBalance.requestGet("https://10minutemail.net/mailbox.ajax.php?_="+(new Date).getTime(),addHeaders({Referer:"https://10minutemail.net/","X-Requested-With":"XMLHttpRequest"}));
if(!/<table[^>]+maillist/i.test(a))throw AnyBalance.trace(a),new AnyBalance.Error("Не удалось проверить е-мейл!");a=getElements(a,/<tr[^>]+onclick[^>]*>/ig);for(var e=[],b=0;b<a.length;++b){var f=a[b];if(!/mid=welcome/i.test(f)){var c=getParam(f,null,null,/<a[^>]+href="readmail[^>]*>([\s\S]*?)<\/a>/i,replaceTagsAndSpaces),d=getParam(f,null,null,/<a[^>]+href="readmail.html\?mid=([^"]*)/i),h=getParam(f,null,null,/<td[^>]*>([\s\S]*?)<\/td>/i,replaceTagsAndSpaces),f=getParam(f,null,null,/<span[^>]*title="(\d{4}[^"]*)/i,
replaceHtmlEntities,parseDateISO);e.push({name:c,id:d,from:h,time:f})}}a=e;for(e=0;e<a.length;++e){b=a[e];if(!p[b.id]){AnyBalance.trace("Получаем емейл от "+b.from+": "+b.name);d=b;AnyBalance.trace("Fetching email "+d.name+" from "+d.from);c=AnyBalance.requestGet("https://10minutemail.net/readmail.html?mid="+encodeURIComponent(d.id),addHeaders({Referer:"https://10minutemail.net/"}));d.text=getElement(c,/<div[^>]+id="tabs-1"[^>]*>/i,replaceTagsAndSpaces);d.html=getElement(c,/<div[^>]+id="mailinhtml"[^>]*>/i);
if(c=getElement(c,/<div[^>]+id="tabs-5"[^>]*>/i))for(c=getElements(c,/<a[^>]+href="attachment[^>]*>/ig),AnyBalance.trace("Email "+d.name+" has "+c.length+" attachments"),d=d.attachments=[],h=0;h<c.length;h++){var k=c[h],f=getParam(k,null,null,null,replaceTagsAndSpaces),k=getParam(k,null,null,/<a[^>]+href="([^"]*)/i);d.push({name:f,url:"https://10minutemail.net/"+k});AnyBalance.trace("Attachment found: "+f+": "+k)}p[b.id]=b;m&&m(b)}a[e]=p[b.id]}if(a.length>=n)return a;e=(new Date).getTime();if(e-g>=
(r||12E5))return AnyBalance.trace("Ждем емейл слишком долго, терпения больше нет, выходим."),a;57E4<=e-q.getTime()&&(AnyBalance.trace("Требуется продлить e-mail, продлеваем."),q=new Date,l=AnyBalance.requestGet("https://10minutemail.net/more.html",addHeaders({Referer:"https://10minutemail.net/"})));AnyBalance.sleep(1E4)}while(1)},fetchAttachment:function(n,g){return AnyBalance.requestGet(n,addHeaders({Referer:"https://10minutemail.net/"}),g)},setOnEmail:function(g){m=g}}};
